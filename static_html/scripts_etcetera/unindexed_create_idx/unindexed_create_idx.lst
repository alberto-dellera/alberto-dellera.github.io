
no rows selected

SQL> select table_name from user_constraints where constraint_type='R';

TABLE_NAME
------------------------------------------------------------------------------------------
NCS_UTENTI_BO
NCS_FUNZIONI_RUOLI_BO
NCS_FUNZIONI_RUOLI_BO
NCS_ATTIVAZIONI
NCS_ATTIVAZIONI
NCS_UTENTI
NCS_UTENTI
NCS_DELEGHE_SAP
NCS_CONTATTI_CLIENTI_SAP
NCS_SIE_X_SITO
NCS_SIE_X_RS
NCS_SIE_X_CONTRATTI
NCS_SIE_X_CONTRATTI
NCS_SIE_X_CLIENTI
NCS_SIE_X_DELEGHE
NCS_SIE_X_DELEGHE

16 rows selected.

SQL> desc v$session_wait
 Name                                                                                Null?    Type
 ----------------------------------------------------------------------------------- -------- --------------------------------------------------------
 SID                                                                                          NUMBER
 SEQ#                                                                                         NUMBER
 EVENT                                                                                        VARCHAR2(64)
 P1TEXT                                                                                       VARCHAR2(64)
 P1                                                                                           NUMBER
 P1RAW                                                                                        RAW(8)
 P2TEXT                                                                                       VARCHAR2(64)
 P2                                                                                           NUMBER
 P2RAW                                                                                        RAW(8)
 P3TEXT                                                                                       VARCHAR2(64)
 P3                                                                                           NUMBER
 P3RAW                                                                                        RAW(8)
 WAIT_CLASS_ID                                                                                NUMBER
 WAIT_CLASS#                                                                                  NUMBER
 WAIT_CLASS                                                                                   VARCHAR2(64)
 WAIT_TIME                                                                                    NUMBER
 SECONDS_IN_WAIT                                                                              NUMBER
 STATE                                                                                        VARCHAR2(19)

SQL> select event from v$session_wait;

EVENT
------------------------------------------------------------------------------------------------------------------------------------------------------
Streams AQ: waiting for messages in the queue
SQL*Net message from client
Streams AQ: waiting for messages in the queue
Streams AQ: waiting for messages in the queue
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from dblink
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
Streams AQ: waiting for messages in the queue
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for messages in the queue
Streams AQ: qmn slave idle wait
SQL*Net message to client
Streams AQ: qmn coordinator idle wait
jobq slave wait
rdbms ipc message
rdbms ipc message
rdbms ipc message
rdbms ipc message
smon timer
rdbms ipc message
rdbms ipc message
rdbms ipc message
rdbms ipc message
rdbms ipc message
pmon timer

36 rows selected.

SQL> select event from v$session_wait;

EVENT
------------------------------------------------------------------------------------------------------------------------------------------------------
Streams AQ: waiting for messages in the queue
SQL*Net message from client
Streams AQ: waiting for messages in the queue
Streams AQ: waiting for messages in the queue
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from dblink
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
Streams AQ: waiting for messages in the queue
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for messages in the queue
Streams AQ: qmn slave idle wait
SQL*Net message to client
Streams AQ: qmn coordinator idle wait
jobq slave wait
rdbms ipc message
rdbms ipc message
rdbms ipc message
rdbms ipc message
smon timer
rdbms ipc message
rdbms ipc message
rdbms ipc message
rdbms ipc message
rdbms ipc message
pmon timer

36 rows selected.

SQL> select event from v$session_wait;

EVENT
------------------------------------------------------------------------------------------------------------------------------------------------------
Streams AQ: waiting for messages in the queue
SQL*Net message from client
Streams AQ: waiting for messages in the queue
Streams AQ: waiting for messages in the queue
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
SQL*Net message from dblink
SQL*Net message from client
SQL*Net message from client
SQL*Net message from client
Streams AQ: waiting for messages in the queue
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for time management or cleanup tasks
Streams AQ: waiting for messages in the queue
Streams AQ: qmn slave idle wait
SQL*Net message to client
Streams AQ: qmn coordinator idle wait
jobq slave wait
rdbms ipc message
rdbms ipc message
rdbms ipc message
rdbms ipc message
smon timer
rdbms ipc message
rdbms ipc message
rdbms ipc message
rdbms ipc message
rdbms ipc message
pmon timer

36 rows selected.

SQL> select sid, event from v$session_wait;

       SID
----------
EVENT
------------------------------------------------------------------------------------------------------------------------------------------------------
       119
Streams AQ: waiting for messages in the queue

       120
SQL*Net message from client

       121
Streams AQ: waiting for messages in the queue

       126
Streams AQ: waiting for messages in the queue

       127
SQL*Net message from client

       128
SQL*Net message from client

       129
SQL*Net message from client

       130
SQL*Net message from client

       131
SQL*Net message from client

       132
SQL*Net message from client

       133
SQL*Net message from dblink

       136
SQL*Net message from client

       137
SQL*Net message from client

       138
SQL*Net message from client

       139
Streams AQ: waiting for messages in the queue

       142
Streams AQ: waiting for time management or cleanup tasks

       143
Streams AQ: waiting for time management or cleanup tasks

       144
Streams AQ: waiting for time management or cleanup tasks

       145
Streams AQ: waiting for time management or cleanup tasks

       147
Streams AQ: waiting for time management or cleanup tasks

       148
Streams AQ: waiting for messages in the queue

       151
Streams AQ: qmn slave idle wait

       152
SQL*Net message to client

       154
Streams AQ: qmn coordinator idle wait

       158
jobq slave wait

       160
rdbms ipc message

       161
rdbms ipc message

       162
rdbms ipc message

       163
rdbms ipc message

       164
smon timer

       165
rdbms ipc message

       166
rdbms ipc message

       167
rdbms ipc message

       168
rdbms ipc message

       169
rdbms ipc message

       170
pmon timer


36 rows selected.

SQL> col event form a40
SQL> /

       SID EVENT
---------- ----------------------------------------
       119 Streams AQ: waiting for messages in the
           queue

       120 SQL*Net message from client
       121 Streams AQ: waiting for messages in the
           queue

       126 Streams AQ: waiting for messages in the
           queue

       127 SQL*Net message from client
       128 SQL*Net message from client
       129 SQL*Net message from client
       130 SQL*Net message from client
       131 SQL*Net message from client
       132 SQL*Net message from client
       133 SQL*Net message from dblink
       136 SQL*Net message from client
       137 SQL*Net message from client
       138 SQL*Net message from client
       139 Streams AQ: waiting for messages in the
           queue

       142 Streams AQ: waiting for time management
           or cleanup tasks

       143 Streams AQ: waiting for time management
           or cleanup tasks

       144 Streams AQ: waiting for time management
           or cleanup tasks

       145 Streams AQ: waiting for time management
           or cleanup tasks

       147 Streams AQ: waiting for time management
           or cleanup tasks

       148 Streams AQ: waiting for messages in the
           queue

       151 Streams AQ: qmn slave idle wait
       152 SQL*Net message to client
       154 Streams AQ: qmn coordinator idle wait
       158 jobq slave wait
       160 rdbms ipc message
       161 rdbms ipc message
       162 rdbms ipc message
       163 rdbms ipc message
       164 smon timer
       165 control file parallel write
       166 rdbms ipc message
       167 rdbms ipc message
       168 rdbms ipc message
       169 rdbms ipc message
       170 pmon timer

36 rows selected.

SQL> col event form a60
SQL> /

       SID EVENT
---------- ------------------------------------------------------------
       119 Streams AQ: waiting for messages in the queue
       120 SQL*Net message from client
       121 Streams AQ: waiting for messages in the queue
       126 Streams AQ: waiting for messages in the queue
       127 SQL*Net message from client
       128 SQL*Net message from client
       129 SQL*Net message from client
       130 SQL*Net message from client
       131 SQL*Net message from client
       132 SQL*Net message from client
       133 SQL*Net message from dblink
       136 SQL*Net message from client
       137 SQL*Net message from client
       138 SQL*Net message from client
       139 Streams AQ: waiting for messages in the queue
       142 Streams AQ: waiting for time management or cleanup tasks
       143 Streams AQ: waiting for time management or cleanup tasks
       144 Streams AQ: waiting for time management or cleanup tasks
       145 Streams AQ: waiting for time management or cleanup tasks
       147 Streams AQ: waiting for time management or cleanup tasks
       148 Streams AQ: waiting for messages in the queue
       151 Streams AQ: qmn slave idle wait
       152 SQL*Net message to client
       154 Streams AQ: qmn coordinator idle wait
       158 jobq slave wait
       160 rdbms ipc message
       161 rdbms ipc message
       162 rdbms ipc message
       163 rdbms ipc message
       164 smon timer
       165 rdbms ipc message
       166 rdbms ipc message
       167 rdbms ipc message
       168 rdbms ipc message
       169 rdbms ipc message
       170 pmon timer

36 rows selected.

SQL> select sid, event from v$session_wait order by sid;

       SID EVENT
---------- ------------------------------------------------------------
       119 Streams AQ: waiting for messages in the queue
       120 SQL*Net message from client
       121 Streams AQ: waiting for messages in the queue
       126 Streams AQ: waiting for messages in the queue
       127 SQL*Net message from client
       128 SQL*Net message from client
       129 SQL*Net message from client
       130 SQL*Net message from client
       131 SQL*Net message from client
       132 SQL*Net message from client
       133 SQL*Net message from dblink
       136 SQL*Net message from client
       137 SQL*Net message from client
       138 SQL*Net message from client
       139 Streams AQ: waiting for messages in the queue
       142 Streams AQ: waiting for time management or cleanup tasks
       143 Streams AQ: waiting for time management or cleanup tasks
       144 Streams AQ: waiting for time management or cleanup tasks
       145 Streams AQ: waiting for time management or cleanup tasks
       147 Streams AQ: waiting for time management or cleanup tasks
       148 Streams AQ: waiting for messages in the queue
       151 Streams AQ: qmn slave idle wait
       152 SQL*Net message to client
       154 Streams AQ: qmn coordinator idle wait
       158 jobq slave wait
       160 rdbms ipc message
       161 rdbms ipc message
       162 rdbms ipc message
       163 rdbms ipc message
       164 smon timer
       165 rdbms ipc message
       166 rdbms ipc message
       167 rdbms ipc message
       168 rdbms ipc message
       169 rdbms ipc message
       170 pmon timer

36 rows selected.

SQL> select sid, event from v$session_wait order by sid;

       SID EVENT
---------- ------------------------------------------------------------
       119 Streams AQ: waiting for messages in the queue
       120 SQL*Net message from client
       121 Streams AQ: waiting for messages in the queue
       126 Streams AQ: waiting for messages in the queue
       127 SQL*Net message from client
       128 SQL*Net message from client
       129 SQL*Net message from client
       130 SQL*Net message from client
       131 SQL*Net message from client
       132 SQL*Net message from client
       133 SQL*Net message from dblink
       136 SQL*Net message from client
       137 SQL*Net message from client
       138 SQL*Net message from client
       139 Streams AQ: waiting for messages in the queue
       142 Streams AQ: waiting for time management or cleanup tasks
       143 Streams AQ: waiting for time management or cleanup tasks
       144 Streams AQ: waiting for time management or cleanup tasks
       145 Streams AQ: waiting for time management or cleanup tasks
       147 Streams AQ: waiting for time management or cleanup tasks
       148 Streams AQ: waiting for messages in the queue
       151 Streams AQ: qmn slave idle wait
       152 SQL*Net message to client
       154 Streams AQ: qmn coordinator idle wait
       158 jobq slave wait
       160 rdbms ipc message
       161 rdbms ipc message
       162 rdbms ipc message
       163 rdbms ipc message
       164 smon timer
       165 rdbms ipc message
       166 rdbms ipc message
       167 rdbms ipc message
       168 rdbms ipc message
       169 rdbms ipc message
       170 pmon timer

36 rows selected.

SQL> select sid, event from v$session_wait order by sid;

       SID EVENT
---------- ------------------------------------------------------------
       119 Streams AQ: waiting for messages in the queue
       120 SQL*Net message from client
       121 Streams AQ: waiting for messages in the queue
       126 Streams AQ: waiting for messages in the queue
       127 SQL*Net message from client
       128 SQL*Net message from client
       129 SQL*Net message from client
       130 SQL*Net message from client
       131 SQL*Net message from client
       132 SQL*Net message from client
       133 SQL*Net message from dblink
       136 SQL*Net message from client
       137 SQL*Net message from client
       138 SQL*Net message from client
       139 Streams AQ: waiting for messages in the queue
       142 Streams AQ: waiting for time management or cleanup tasks
       143 Streams AQ: waiting for time management or cleanup tasks
       144 Streams AQ: waiting for time management or cleanup tasks
       145 Streams AQ: waiting for time management or cleanup tasks
       147 Streams AQ: waiting for time management or cleanup tasks
       148 Streams AQ: waiting for messages in the queue
       151 Streams AQ: qmn slave idle wait
       152 SQL*Net message to client
       154 Streams AQ: qmn coordinator idle wait
       158 jobq slave wait
       160 rdbms ipc message
       161 rdbms ipc message
       162 rdbms ipc message
       163 rdbms ipc message
       164 smon timer
       165 rdbms ipc message
       166 rdbms ipc message
       167 rdbms ipc message
       168 rdbms ipc message
       169 rdbms ipc message
       170 pmon timer

36 rows selected.

SQL> desc v$session_wait
 Name                                                                                Null?    Type
 ----------------------------------------------------------------------------------- -------- --------------------------------------------------------
 SID                                                                                          NUMBER
 SEQ#                                                                                         NUMBER
 EVENT                                                                                        VARCHAR2(64)
 P1TEXT                                                                                       VARCHAR2(64)
 P1                                                                                           NUMBER
 P1RAW                                                                                        RAW(8)
 P2TEXT                                                                                       VARCHAR2(64)
 P2                                                                                           NUMBER
 P2RAW                                                                                        RAW(8)
 P3TEXT                                                                                       VARCHAR2(64)
 P3                                                                                           NUMBER
 P3RAW                                                                                        RAW(8)
 WAIT_CLASS_ID                                                                                NUMBER
 WAIT_CLASS#                                                                                  NUMBER
 WAIT_CLASS                                                                                   VARCHAR2(64)
 WAIT_TIME                                                                                    NUMBER
 SECONDS_IN_WAIT                                                                              NUMBER
 STATE                                                                                        VARCHAR2(19)

SQL> select sid, event from v$session_wait order by sid;

       SID EVENT
---------- ------------------------------------------------------------
       119 Streams AQ: waiting for messages in the queue
       120 SQL*Net message from client
       121 Streams AQ: waiting for messages in the queue
       126 Streams AQ: waiting for messages in the queue
       127 SQL*Net message from client
       128 SQL*Net message from client
       129 SQL*Net message from client
       130 SQL*Net message from client
       131 SQL*Net message from client
       132 SQL*Net message from client
       136 SQL*Net message from client
       137 SQL*Net message from client
       138 SQL*Net message from client
       139 Streams AQ: waiting for messages in the queue
       142 Streams AQ: waiting for time management or cleanup tasks
       143 Streams AQ: waiting for time management or cleanup tasks
       144 Streams AQ: waiting for time management or cleanup tasks
       145 Streams AQ: waiting for time management or cleanup tasks
       147 Streams AQ: waiting for time management or cleanup tasks
       148 Streams AQ: waiting for messages in the queue
       151 Streams AQ: qmn slave idle wait
       152 SQL*Net message to client
       154 Streams AQ: qmn coordinator idle wait
       158 jobq slave wait
       160 rdbms ipc message
       161 rdbms ipc message
       162 rdbms ipc message
       163 rdbms ipc message
       164 smon timer
       165 rdbms ipc message
       166 rdbms ipc message
       167 rdbms ipc message
       168 rdbms ipc message
       169 rdbms ipc message
       170 pmon timer

35 rows selected.

SQL> select sid, event from v$session_wait order by sid;

       SID EVENT
---------- ------------------------------------------------------------
       119 Streams AQ: waiting for messages in the queue
       120 SQL*Net message from client
       121 Streams AQ: waiting for messages in the queue
       126 Streams AQ: waiting for messages in the queue
       127 SQL*Net message from client
       128 SQL*Net message from client
       129 SQL*Net message from client
       130 SQL*Net message from client
       131 SQL*Net message from client
       132 SQL*Net message from client
       136 SQL*Net message from client
       137 SQL*Net message from client
       138 SQL*Net message from client
       139 Streams AQ: waiting for messages in the queue
       142 Streams AQ: waiting for time management or cleanup tasks
       143 Streams AQ: waiting for time management or cleanup tasks
       144 Streams AQ: waiting for time management or cleanup tasks
       145 Streams AQ: waiting for time management or cleanup tasks
       147 Streams AQ: waiting for time management or cleanup tasks
       148 Streams AQ: waiting for messages in the queue
       151 Streams AQ: qmn slave idle wait
       152 SQL*Net message to client
       154 Streams AQ: qmn coordinator idle wait
       158 jobq slave wait
       160 rdbms ipc message
       161 rdbms ipc message
       162 rdbms ipc message
       163 rdbms ipc message
       164 smon timer
       165 rdbms ipc message
       166 rdbms ipc message
       167 rdbms ipc message
       168 rdbms ipc message
       169 rdbms ipc message
       170 pmon timer

35 rows selected.

SQL> truncate table ncs_logM
  2  ;
truncate table ncs_logM
               *
ERROR at line 1:
ORA-00942: table or view does not exist


SQL> truncate table ncs_log;

Table truncated.

SQL> select msg from ncs_log order by id;

MSG
------------------------------------------------------------------------------------------------------------------------------------------------------
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=19/03/2010 15:40:36
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:40:39
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito

83 rows selected.

SQL> select msg from ncs_log order by id;

MSG
------------------------------------------------------------------------------------------------------------------------------------------------------
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=19/03/2010 15:40:36
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:40:39
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:42:33
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:48
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CLIENTI purge
PK     columns of NCS_SIE_X_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_X_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
PK     columns of NCS_SIE_Y_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_Y_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
create or replace view NCS_SIE_V_CLIENTI
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_X_CLIE
NTI

  union all
  select 'O' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_Y_CLIE
NTI

  ), x2 as (
  select CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE
,VIA

  from x3
adapting/creating history table of NCS_SIE_X_CLIENTI
create table NCS_SIE_H_CLIENTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CLIENTI_idx on NCS_SIE_H_CLIENTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CLIENTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CLIENTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (EMAIL varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CLIENTI add (RAGIONE_SOCIALE varchar2(100 byte))
alter table NCS_SIE_H_CLIENTI add (SEGMENTO_CLIENTE varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CLIENTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIE
NTE,VIA from NCS_SIE_V_CLIENTI where 1=0

alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CLIENTI modify (CODICE_CLIENTE not null)
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTATTI purge
PK     columns of NCS_SIE_X_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_X_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
PK     columns of NCS_SIE_Y_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_Y_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
create or replace view NCS_SIE_V_CONTATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_X_CONTATTI
  union all
  select 'O' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_Y_CONTATTI
  ), x2 as (
  select ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  from x3
adapting/creating history table of NCS_SIE_X_CONTATTI
create table NCS_SIE_H_CONTATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
 null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTATTI_idx on NCS_SIE_H_CONTATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (CELL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (COGNOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (EMAIL varchar2(100 byte))
alter table NCS_SIE_H_CONTATTI add (FAX varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (NOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (TEL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CONTATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last
_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA fro
m NCS_SIE_V_CONTATTI where 1=0

alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTATTI modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTRATTI purge
PK     columns of NCS_SIE_X_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_X_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

PK     columns of NCS_SIE_Y_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

create or replace view NCS_SIE_V_CONTRATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_X_CONTRATTI

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_Y_CONTRATTI

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADEN
ZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA
_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,
VIA_FILIALE, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCA
DENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIF
ICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,V
IA,VIA_FILIALE

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_I
NIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOM
E_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_O
RDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE

  from x3
adapting/creating history table of NCS_SIE_X_CONTRATTI
create table NCS_SIE_H_CONTRATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) no
t null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTRATTI_idx on NCS_SIE_H_CONTRATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTRATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (CONSUMO_ANNUO_STIMATO number)
alter table NCS_SIE_H_CONTRATTI add (CONTRACT_ACCOUNT varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (DATA_INIZIO_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_FINE_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_SCADENZA_SERVIZIO date)
alter table NCS_SIE_H_CONTRATTI add (FILIALE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (IBAN varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (IMPOSTE_AGEVOLATE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_DETT_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (LOC_FILIALE varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (MOD_PAGAMENTO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_BANCA varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_OFFERTA varchar2(400 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_MAIL varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_SMS varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (PIANO_TARIFFARIO varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTRATTI add (PROV_FILIALE varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPOLOGIA_UTENZA varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_OFFERTA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_ORDERITEM varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TRATTAMENTO_IVA varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA varchar2(300 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA_FILIALE varchar2(50 byte))
create table NCS_SIE_D_CONTRATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_las
t_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,D
ATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZION
E,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,T
IPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_V_CONTRATTI where 1=0

alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTRATTI modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI


359 rows selected.

SQL> select msg from ncs_log order by id;

MSG
------------------------------------------------------------------------------------------------------------------------------------------------------
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=19/03/2010 15:40:36
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:40:39
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:42:33
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:48
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CLIENTI purge
PK     columns of NCS_SIE_X_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_X_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
PK     columns of NCS_SIE_Y_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_Y_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
create or replace view NCS_SIE_V_CLIENTI
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_X_CLIE
NTI

  union all
  select 'O' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_Y_CLIE
NTI

  ), x2 as (
  select CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE
,VIA

  from x3
adapting/creating history table of NCS_SIE_X_CLIENTI
create table NCS_SIE_H_CLIENTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CLIENTI_idx on NCS_SIE_H_CLIENTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CLIENTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CLIENTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (EMAIL varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CLIENTI add (RAGIONE_SOCIALE varchar2(100 byte))
alter table NCS_SIE_H_CLIENTI add (SEGMENTO_CLIENTE varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CLIENTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIE
NTE,VIA from NCS_SIE_V_CLIENTI where 1=0

alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CLIENTI modify (CODICE_CLIENTE not null)
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTATTI purge
PK     columns of NCS_SIE_X_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_X_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
PK     columns of NCS_SIE_Y_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_Y_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
create or replace view NCS_SIE_V_CONTATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_X_CONTATTI
  union all
  select 'O' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_Y_CONTATTI
  ), x2 as (
  select ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  from x3
adapting/creating history table of NCS_SIE_X_CONTATTI
create table NCS_SIE_H_CONTATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
 null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTATTI_idx on NCS_SIE_H_CONTATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (CELL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (COGNOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (EMAIL varchar2(100 byte))
alter table NCS_SIE_H_CONTATTI add (FAX varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (NOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (TEL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CONTATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last
_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA fro
m NCS_SIE_V_CONTATTI where 1=0

alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTATTI modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTRATTI purge
PK     columns of NCS_SIE_X_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_X_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

PK     columns of NCS_SIE_Y_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

create or replace view NCS_SIE_V_CONTRATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_X_CONTRATTI

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_Y_CONTRATTI

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADEN
ZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA
_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,
VIA_FILIALE, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCA
DENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIF
ICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,V
IA,VIA_FILIALE

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_I
NIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOM
E_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_O
RDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE

  from x3
adapting/creating history table of NCS_SIE_X_CONTRATTI
create table NCS_SIE_H_CONTRATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) no
t null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTRATTI_idx on NCS_SIE_H_CONTRATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTRATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (CONSUMO_ANNUO_STIMATO number)
alter table NCS_SIE_H_CONTRATTI add (CONTRACT_ACCOUNT varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (DATA_INIZIO_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_FINE_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_SCADENZA_SERVIZIO date)
alter table NCS_SIE_H_CONTRATTI add (FILIALE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (IBAN varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (IMPOSTE_AGEVOLATE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_DETT_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (LOC_FILIALE varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (MOD_PAGAMENTO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_BANCA varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_OFFERTA varchar2(400 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_MAIL varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_SMS varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (PIANO_TARIFFARIO varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTRATTI add (PROV_FILIALE varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPOLOGIA_UTENZA varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_OFFERTA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_ORDERITEM varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TRATTAMENTO_IVA varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA varchar2(300 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA_FILIALE varchar2(50 byte))
create table NCS_SIE_D_CONTRATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_las
t_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,D
ATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZION
E,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,T
IPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_V_CONTRATTI where 1=0

alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTRATTI modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE group are not aligned; starting alignment.
drop table NCS_SIE_D_DELEGHE purge
PK     columns of NCS_SIE_X_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_X_DELEGHE:
PK     columns of NCS_SIE_Y_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_Y_DELEGHE:
create or replace view NCS_SIE_V_DELEGHE
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_X_DELEGHE
  union all
  select 'O' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_Y_DELEGHE
  ), x2 as (
  select CODICE_CLIENTE,ID_CONTATTO, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,ID_CONTATTO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE,ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,ID_CONTATTO
  from x3
adapting/creating history table of NCS_SIE_X_DELEGHE
create table NCS_SIE_H_DELEGHE ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_DELEGHE_idx on NCS_SIE_H_DELEGHE (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_DELEGHE add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_DELEGHE add (ID_CONTATTO varchar2(15 byte))
create table NCS_SIE_D_DELEGHE nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE where 1=0

alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_DELEGHE modify (CODICE_CLIENTE not null)
alter table NCS_SIE_D_DELEGHE modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS group are not aligned; starting alignment.
drop table NCS_SIE_D_RS purge
PK     columns of NCS_SIE_X_RS: N_RS
non-PK columns of NCS_SIE_X_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
PK     columns of NCS_SIE_Y_RS: N_RS
non-PK columns of NCS_SIE_Y_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
create or replace view NCS_SIE_V_RS
    as
  with x1 as (
  select 'N' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_X_RS

  union all
  select 'O' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_Y_RS

  ), x2 as (
  select N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO, max(dml#source) as ncs_dml
_old_new

    from x1
   group by N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by N_RS) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTO
TIPO,STATO,TIPO

  from x3
adapting/creating history table of NCS_SIE_X_RS
create table NCS_SIE_H_RS ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not null
) tablespace NCSADM_DATA

comment on column NCS_SIE_H_RS.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_RS.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_RS.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_RS_idx on NCS_SIE_H_RS (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_RS add (AREA varchar2(200 byte))
alter table NCS_SIE_H_RS add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_RS add (DATA_APERTURA date)
alter table NCS_SIE_H_RS add (DATA_CHIUSURA date)
alter table NCS_SIE_H_RS add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (N_RS varchar2(256 byte))
alter table NCS_SIE_H_RS add (RS_DESCRIZIONE varchar2(4000 byte))
alter table NCS_SIE_H_RS add (SOTTOTIPO varchar2(30 byte))
alter table NCS_SIE_H_RS add (STATO varchar2(120 byte))
alter table NCS_SIE_H_RS add (TIPO varchar2(120 byte))
create table NCS_SIE_D_RS nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_type,
 cast('x' as varchar2(1 char)) as ncs_dml_old_new,N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTI
PO,STATO,TIPO from NCS_SIE_V_RS where 1=0

alter table NCS_SIE_D_RS modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_RS modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_RS modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_RS modify (N_RS not null)
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO group are not aligned; starting alignment.
drop table NCS_SIE_D_SITO purge
PK     columns of NCS_SIE_X_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_X_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

PK     columns of NCS_SIE_Y_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

create or replace view NCS_SIE_V_SITO
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_X_SITO

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_Y_SITO

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PRO
VINCIA,TENSIONE,TIPO_CONTATORE,VIA, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,
PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  from x3
adapting/creating history table of NCS_SIE_X_SITO
create table NCS_SIE_H_SITO ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not nul
l ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_SITO.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_SITO.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_SITO.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_SITO_idx on NCS_SIE_H_SITO (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_SITO add (CAP varchar2(120 byte))
alter table NCS_SIE_H_SITO add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_SITO add (CODICE_USO varchar2(200 byte))
alter table NCS_SIE_H_SITO add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_SITO add (LIVELLO_TENSIONE varchar2(200 byte))
alter table NCS_SIE_H_SITO add (MATRICOLA_CONTATORE varchar2(100 byte))
alter table NCS_SIE_H_SITO add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (NUMERO_PRESA varchar2(100 byte))
alter table NCS_SIE_H_SITO add (PDR varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POD varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POTENZA_DISPONIBILE number)
alter table NCS_SIE_H_SITO add (POTENZA_IMPEGNATA number)
alter table NCS_SIE_H_SITO add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_SITO add (TENSIONE varchar2(50 byte))
alter table NCS_SIE_H_SITO add (TIPO_CONTATORE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (VIA varchar2(300 byte))
create table NCS_SIE_D_SITO nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_typ
e, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO where 1=0

alter table NCS_SIE_D_SITO modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_SITO modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
locking stats of table NCS_SIE_D_CLIENTI
locking stats of table NCS_SIE_H_CLIENTI
locking stats of table NCS_SIE_H_CONTATTI
locking stats of table NCS_SIE_H_RS
locking stats of table NCS_SIE_D_DELEGHE
locking stats of table NCS_SIE_D_CONTATTI
locking stats of table NCS_SIE_D_CONTRATTI
locking stats of table NCS_SIE_D_RS
locking stats of table NCS_SIE_D_SITO
locking stats of table NCS_SIE_H_CONTRATTI
locking stats of table NCS_SIE_H_SITO
locking stats of table NCS_SIE_H_DELEGHE
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for MV_CAPABILITIES_TABLE
end of gather_table_stats_wrap for MV_CAPABILITIES_TABLE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB

623 rows selected.

SQL> select msg from ncs_log order by id;

MSG
------------------------------------------------------------------------------------------------------------------------------------------------------
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=19/03/2010 15:40:36
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:40:39
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:42:33
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:48
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CLIENTI purge
PK     columns of NCS_SIE_X_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_X_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
PK     columns of NCS_SIE_Y_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_Y_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
create or replace view NCS_SIE_V_CLIENTI
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_X_CLIE
NTI

  union all
  select 'O' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_Y_CLIE
NTI

  ), x2 as (
  select CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE
,VIA

  from x3
adapting/creating history table of NCS_SIE_X_CLIENTI
create table NCS_SIE_H_CLIENTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CLIENTI_idx on NCS_SIE_H_CLIENTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CLIENTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CLIENTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (EMAIL varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CLIENTI add (RAGIONE_SOCIALE varchar2(100 byte))
alter table NCS_SIE_H_CLIENTI add (SEGMENTO_CLIENTE varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CLIENTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIE
NTE,VIA from NCS_SIE_V_CLIENTI where 1=0

alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CLIENTI modify (CODICE_CLIENTE not null)
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTATTI purge
PK     columns of NCS_SIE_X_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_X_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
PK     columns of NCS_SIE_Y_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_Y_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
create or replace view NCS_SIE_V_CONTATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_X_CONTATTI
  union all
  select 'O' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_Y_CONTATTI
  ), x2 as (
  select ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  from x3
adapting/creating history table of NCS_SIE_X_CONTATTI
create table NCS_SIE_H_CONTATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
 null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTATTI_idx on NCS_SIE_H_CONTATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (CELL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (COGNOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (EMAIL varchar2(100 byte))
alter table NCS_SIE_H_CONTATTI add (FAX varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (NOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (TEL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CONTATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last
_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA fro
m NCS_SIE_V_CONTATTI where 1=0

alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTATTI modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTRATTI purge
PK     columns of NCS_SIE_X_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_X_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

PK     columns of NCS_SIE_Y_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

create or replace view NCS_SIE_V_CONTRATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_X_CONTRATTI

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_Y_CONTRATTI

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADEN
ZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA
_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,
VIA_FILIALE, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCA
DENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIF
ICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,V
IA,VIA_FILIALE

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_I
NIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOM
E_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_O
RDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE

  from x3
adapting/creating history table of NCS_SIE_X_CONTRATTI
create table NCS_SIE_H_CONTRATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) no
t null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTRATTI_idx on NCS_SIE_H_CONTRATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTRATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (CONSUMO_ANNUO_STIMATO number)
alter table NCS_SIE_H_CONTRATTI add (CONTRACT_ACCOUNT varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (DATA_INIZIO_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_FINE_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_SCADENZA_SERVIZIO date)
alter table NCS_SIE_H_CONTRATTI add (FILIALE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (IBAN varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (IMPOSTE_AGEVOLATE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_DETT_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (LOC_FILIALE varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (MOD_PAGAMENTO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_BANCA varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_OFFERTA varchar2(400 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_MAIL varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_SMS varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (PIANO_TARIFFARIO varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTRATTI add (PROV_FILIALE varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPOLOGIA_UTENZA varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_OFFERTA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_ORDERITEM varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TRATTAMENTO_IVA varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA varchar2(300 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA_FILIALE varchar2(50 byte))
create table NCS_SIE_D_CONTRATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_las
t_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,D
ATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZION
E,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,T
IPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_V_CONTRATTI where 1=0

alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTRATTI modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE group are not aligned; starting alignment.
drop table NCS_SIE_D_DELEGHE purge
PK     columns of NCS_SIE_X_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_X_DELEGHE:
PK     columns of NCS_SIE_Y_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_Y_DELEGHE:
create or replace view NCS_SIE_V_DELEGHE
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_X_DELEGHE
  union all
  select 'O' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_Y_DELEGHE
  ), x2 as (
  select CODICE_CLIENTE,ID_CONTATTO, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,ID_CONTATTO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE,ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,ID_CONTATTO
  from x3
adapting/creating history table of NCS_SIE_X_DELEGHE
create table NCS_SIE_H_DELEGHE ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_DELEGHE_idx on NCS_SIE_H_DELEGHE (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_DELEGHE add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_DELEGHE add (ID_CONTATTO varchar2(15 byte))
create table NCS_SIE_D_DELEGHE nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE where 1=0

alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_DELEGHE modify (CODICE_CLIENTE not null)
alter table NCS_SIE_D_DELEGHE modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS group are not aligned; starting alignment.
drop table NCS_SIE_D_RS purge
PK     columns of NCS_SIE_X_RS: N_RS
non-PK columns of NCS_SIE_X_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
PK     columns of NCS_SIE_Y_RS: N_RS
non-PK columns of NCS_SIE_Y_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
create or replace view NCS_SIE_V_RS
    as
  with x1 as (
  select 'N' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_X_RS

  union all
  select 'O' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_Y_RS

  ), x2 as (
  select N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO, max(dml#source) as ncs_dml
_old_new

    from x1
   group by N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by N_RS) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTO
TIPO,STATO,TIPO

  from x3
adapting/creating history table of NCS_SIE_X_RS
create table NCS_SIE_H_RS ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not null
) tablespace NCSADM_DATA

comment on column NCS_SIE_H_RS.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_RS.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_RS.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_RS_idx on NCS_SIE_H_RS (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_RS add (AREA varchar2(200 byte))
alter table NCS_SIE_H_RS add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_RS add (DATA_APERTURA date)
alter table NCS_SIE_H_RS add (DATA_CHIUSURA date)
alter table NCS_SIE_H_RS add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (N_RS varchar2(256 byte))
alter table NCS_SIE_H_RS add (RS_DESCRIZIONE varchar2(4000 byte))
alter table NCS_SIE_H_RS add (SOTTOTIPO varchar2(30 byte))
alter table NCS_SIE_H_RS add (STATO varchar2(120 byte))
alter table NCS_SIE_H_RS add (TIPO varchar2(120 byte))
create table NCS_SIE_D_RS nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_type,
 cast('x' as varchar2(1 char)) as ncs_dml_old_new,N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTI
PO,STATO,TIPO from NCS_SIE_V_RS where 1=0

alter table NCS_SIE_D_RS modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_RS modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_RS modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_RS modify (N_RS not null)
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO group are not aligned; starting alignment.
drop table NCS_SIE_D_SITO purge
PK     columns of NCS_SIE_X_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_X_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

PK     columns of NCS_SIE_Y_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

create or replace view NCS_SIE_V_SITO
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_X_SITO

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_Y_SITO

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PRO
VINCIA,TENSIONE,TIPO_CONTATORE,VIA, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,
PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  from x3
adapting/creating history table of NCS_SIE_X_SITO
create table NCS_SIE_H_SITO ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not nul
l ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_SITO.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_SITO.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_SITO.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_SITO_idx on NCS_SIE_H_SITO (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_SITO add (CAP varchar2(120 byte))
alter table NCS_SIE_H_SITO add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_SITO add (CODICE_USO varchar2(200 byte))
alter table NCS_SIE_H_SITO add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_SITO add (LIVELLO_TENSIONE varchar2(200 byte))
alter table NCS_SIE_H_SITO add (MATRICOLA_CONTATORE varchar2(100 byte))
alter table NCS_SIE_H_SITO add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (NUMERO_PRESA varchar2(100 byte))
alter table NCS_SIE_H_SITO add (PDR varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POD varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POTENZA_DISPONIBILE number)
alter table NCS_SIE_H_SITO add (POTENZA_IMPEGNATA number)
alter table NCS_SIE_H_SITO add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_SITO add (TENSIONE varchar2(50 byte))
alter table NCS_SIE_H_SITO add (TIPO_CONTATORE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (VIA varchar2(300 byte))
create table NCS_SIE_D_SITO nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_typ
e, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO where 1=0

alter table NCS_SIE_D_SITO modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_SITO modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
locking stats of table NCS_SIE_D_CLIENTI
locking stats of table NCS_SIE_H_CLIENTI
locking stats of table NCS_SIE_H_CONTATTI
locking stats of table NCS_SIE_H_RS
locking stats of table NCS_SIE_D_DELEGHE
locking stats of table NCS_SIE_D_CONTATTI
locking stats of table NCS_SIE_D_CONTRATTI
locking stats of table NCS_SIE_D_RS
locking stats of table NCS_SIE_D_SITO
locking stats of table NCS_SIE_H_CONTRATTI
locking stats of table NCS_SIE_H_SITO
locking stats of table NCS_SIE_H_DELEGHE
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for MV_CAPABILITIES_TABLE
end of gather_table_stats_wrap for MV_CAPABILITIES_TABLE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI
end of gather_table_stats_wrap for NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_ATTIVAZIONI
end of gather_table_stats_wrap for NCS_ATTIVAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONFIG
end of gather_table_stats_wrap for NCS_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI
end of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BV
end of gather_table_stats_wrap for NCS_UTENTI_BV; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_FILES
end of gather_table_stats_wrap for NCS_BV_USERS_FILES; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_D_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO_SAP
end of gather_table_stats_wrap for NCS_SYNCHRO_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_SAP
end of gather_table_stats_wrap for NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_XY_TTL_CONFIG
end of gather_table_stats_wrap for NCS_XY_TTL_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_UTENTI
end of gather_table_stats_wrap for MLOG$_NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_RS
end of gather_table_stats_wrap for NCS_SIE_D_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RICERCA_BO

675 rows selected.

SQL> select msg from ncs_log order by id;

MSG
------------------------------------------------------------------------------------------------------------------------------------------------------
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=19/03/2010 15:40:36
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:40:39
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:42:33
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:48
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CLIENTI purge
PK     columns of NCS_SIE_X_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_X_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
PK     columns of NCS_SIE_Y_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_Y_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
create or replace view NCS_SIE_V_CLIENTI
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_X_CLIE
NTI

  union all
  select 'O' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_Y_CLIE
NTI

  ), x2 as (
  select CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE
,VIA

  from x3
adapting/creating history table of NCS_SIE_X_CLIENTI
create table NCS_SIE_H_CLIENTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CLIENTI_idx on NCS_SIE_H_CLIENTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CLIENTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CLIENTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (EMAIL varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CLIENTI add (RAGIONE_SOCIALE varchar2(100 byte))
alter table NCS_SIE_H_CLIENTI add (SEGMENTO_CLIENTE varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CLIENTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIE
NTE,VIA from NCS_SIE_V_CLIENTI where 1=0

alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CLIENTI modify (CODICE_CLIENTE not null)
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTATTI purge
PK     columns of NCS_SIE_X_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_X_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
PK     columns of NCS_SIE_Y_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_Y_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
create or replace view NCS_SIE_V_CONTATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_X_CONTATTI
  union all
  select 'O' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_Y_CONTATTI
  ), x2 as (
  select ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  from x3
adapting/creating history table of NCS_SIE_X_CONTATTI
create table NCS_SIE_H_CONTATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
 null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTATTI_idx on NCS_SIE_H_CONTATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (CELL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (COGNOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (EMAIL varchar2(100 byte))
alter table NCS_SIE_H_CONTATTI add (FAX varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (NOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (TEL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CONTATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last
_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA fro
m NCS_SIE_V_CONTATTI where 1=0

alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTATTI modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTRATTI purge
PK     columns of NCS_SIE_X_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_X_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

PK     columns of NCS_SIE_Y_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

create or replace view NCS_SIE_V_CONTRATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_X_CONTRATTI

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_Y_CONTRATTI

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADEN
ZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA
_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,
VIA_FILIALE, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCA
DENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIF
ICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,V
IA,VIA_FILIALE

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_I
NIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOM
E_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_O
RDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE

  from x3
adapting/creating history table of NCS_SIE_X_CONTRATTI
create table NCS_SIE_H_CONTRATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) no
t null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTRATTI_idx on NCS_SIE_H_CONTRATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTRATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (CONSUMO_ANNUO_STIMATO number)
alter table NCS_SIE_H_CONTRATTI add (CONTRACT_ACCOUNT varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (DATA_INIZIO_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_FINE_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_SCADENZA_SERVIZIO date)
alter table NCS_SIE_H_CONTRATTI add (FILIALE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (IBAN varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (IMPOSTE_AGEVOLATE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_DETT_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (LOC_FILIALE varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (MOD_PAGAMENTO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_BANCA varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_OFFERTA varchar2(400 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_MAIL varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_SMS varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (PIANO_TARIFFARIO varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTRATTI add (PROV_FILIALE varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPOLOGIA_UTENZA varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_OFFERTA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_ORDERITEM varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TRATTAMENTO_IVA varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA varchar2(300 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA_FILIALE varchar2(50 byte))
create table NCS_SIE_D_CONTRATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_las
t_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,D
ATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZION
E,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,T
IPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_V_CONTRATTI where 1=0

alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTRATTI modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE group are not aligned; starting alignment.
drop table NCS_SIE_D_DELEGHE purge
PK     columns of NCS_SIE_X_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_X_DELEGHE:
PK     columns of NCS_SIE_Y_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_Y_DELEGHE:
create or replace view NCS_SIE_V_DELEGHE
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_X_DELEGHE
  union all
  select 'O' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_Y_DELEGHE
  ), x2 as (
  select CODICE_CLIENTE,ID_CONTATTO, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,ID_CONTATTO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE,ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,ID_CONTATTO
  from x3
adapting/creating history table of NCS_SIE_X_DELEGHE
create table NCS_SIE_H_DELEGHE ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_DELEGHE_idx on NCS_SIE_H_DELEGHE (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_DELEGHE add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_DELEGHE add (ID_CONTATTO varchar2(15 byte))
create table NCS_SIE_D_DELEGHE nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE where 1=0

alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_DELEGHE modify (CODICE_CLIENTE not null)
alter table NCS_SIE_D_DELEGHE modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS group are not aligned; starting alignment.
drop table NCS_SIE_D_RS purge
PK     columns of NCS_SIE_X_RS: N_RS
non-PK columns of NCS_SIE_X_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
PK     columns of NCS_SIE_Y_RS: N_RS
non-PK columns of NCS_SIE_Y_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
create or replace view NCS_SIE_V_RS
    as
  with x1 as (
  select 'N' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_X_RS

  union all
  select 'O' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_Y_RS

  ), x2 as (
  select N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO, max(dml#source) as ncs_dml
_old_new

    from x1
   group by N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by N_RS) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTO
TIPO,STATO,TIPO

  from x3
adapting/creating history table of NCS_SIE_X_RS
create table NCS_SIE_H_RS ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not null
) tablespace NCSADM_DATA

comment on column NCS_SIE_H_RS.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_RS.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_RS.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_RS_idx on NCS_SIE_H_RS (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_RS add (AREA varchar2(200 byte))
alter table NCS_SIE_H_RS add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_RS add (DATA_APERTURA date)
alter table NCS_SIE_H_RS add (DATA_CHIUSURA date)
alter table NCS_SIE_H_RS add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (N_RS varchar2(256 byte))
alter table NCS_SIE_H_RS add (RS_DESCRIZIONE varchar2(4000 byte))
alter table NCS_SIE_H_RS add (SOTTOTIPO varchar2(30 byte))
alter table NCS_SIE_H_RS add (STATO varchar2(120 byte))
alter table NCS_SIE_H_RS add (TIPO varchar2(120 byte))
create table NCS_SIE_D_RS nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_type,
 cast('x' as varchar2(1 char)) as ncs_dml_old_new,N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTI
PO,STATO,TIPO from NCS_SIE_V_RS where 1=0

alter table NCS_SIE_D_RS modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_RS modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_RS modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_RS modify (N_RS not null)
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO group are not aligned; starting alignment.
drop table NCS_SIE_D_SITO purge
PK     columns of NCS_SIE_X_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_X_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

PK     columns of NCS_SIE_Y_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

create or replace view NCS_SIE_V_SITO
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_X_SITO

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_Y_SITO

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PRO
VINCIA,TENSIONE,TIPO_CONTATORE,VIA, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,
PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  from x3
adapting/creating history table of NCS_SIE_X_SITO
create table NCS_SIE_H_SITO ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not nul
l ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_SITO.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_SITO.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_SITO.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_SITO_idx on NCS_SIE_H_SITO (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_SITO add (CAP varchar2(120 byte))
alter table NCS_SIE_H_SITO add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_SITO add (CODICE_USO varchar2(200 byte))
alter table NCS_SIE_H_SITO add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_SITO add (LIVELLO_TENSIONE varchar2(200 byte))
alter table NCS_SIE_H_SITO add (MATRICOLA_CONTATORE varchar2(100 byte))
alter table NCS_SIE_H_SITO add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (NUMERO_PRESA varchar2(100 byte))
alter table NCS_SIE_H_SITO add (PDR varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POD varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POTENZA_DISPONIBILE number)
alter table NCS_SIE_H_SITO add (POTENZA_IMPEGNATA number)
alter table NCS_SIE_H_SITO add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_SITO add (TENSIONE varchar2(50 byte))
alter table NCS_SIE_H_SITO add (TIPO_CONTATORE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (VIA varchar2(300 byte))
create table NCS_SIE_D_SITO nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_typ
e, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO where 1=0

alter table NCS_SIE_D_SITO modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_SITO modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
locking stats of table NCS_SIE_D_CLIENTI
locking stats of table NCS_SIE_H_CLIENTI
locking stats of table NCS_SIE_H_CONTATTI
locking stats of table NCS_SIE_H_RS
locking stats of table NCS_SIE_D_DELEGHE
locking stats of table NCS_SIE_D_CONTATTI
locking stats of table NCS_SIE_D_CONTRATTI
locking stats of table NCS_SIE_D_RS
locking stats of table NCS_SIE_D_SITO
locking stats of table NCS_SIE_H_CONTRATTI
locking stats of table NCS_SIE_H_SITO
locking stats of table NCS_SIE_H_DELEGHE
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for MV_CAPABILITIES_TABLE
end of gather_table_stats_wrap for MV_CAPABILITIES_TABLE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI
end of gather_table_stats_wrap for NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_ATTIVAZIONI
end of gather_table_stats_wrap for NCS_ATTIVAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONFIG
end of gather_table_stats_wrap for NCS_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI
end of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BV
end of gather_table_stats_wrap for NCS_UTENTI_BV; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_FILES
end of gather_table_stats_wrap for NCS_BV_USERS_FILES; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_D_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO_SAP
end of gather_table_stats_wrap for NCS_SYNCHRO_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_SAP
end of gather_table_stats_wrap for NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_XY_TTL_CONFIG
end of gather_table_stats_wrap for NCS_XY_TTL_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_UTENTI
end of gather_table_stats_wrap for MLOG$_NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_RS
end of gather_table_stats_wrap for NCS_SIE_D_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RICERCA_BO
end of gather_table_stats_wrap for NCS_RICERCA_BO; elapsed=5 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_SITO
end of gather_table_stats_wrap for NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_X_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI

687 rows selected.

SQL> select msg from ncs_log order by id;

MSG
------------------------------------------------------------------------------------------------------------------------------------------------------
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=19/03/2010 15:40:36
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:40:39
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:42:33
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:48
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CLIENTI purge
PK     columns of NCS_SIE_X_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_X_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
PK     columns of NCS_SIE_Y_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_Y_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
create or replace view NCS_SIE_V_CLIENTI
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_X_CLIE
NTI

  union all
  select 'O' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_Y_CLIE
NTI

  ), x2 as (
  select CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE
,VIA

  from x3
adapting/creating history table of NCS_SIE_X_CLIENTI
create table NCS_SIE_H_CLIENTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CLIENTI_idx on NCS_SIE_H_CLIENTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CLIENTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CLIENTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (EMAIL varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CLIENTI add (RAGIONE_SOCIALE varchar2(100 byte))
alter table NCS_SIE_H_CLIENTI add (SEGMENTO_CLIENTE varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CLIENTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIE
NTE,VIA from NCS_SIE_V_CLIENTI where 1=0

alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CLIENTI modify (CODICE_CLIENTE not null)
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTATTI purge
PK     columns of NCS_SIE_X_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_X_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
PK     columns of NCS_SIE_Y_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_Y_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
create or replace view NCS_SIE_V_CONTATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_X_CONTATTI
  union all
  select 'O' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_Y_CONTATTI
  ), x2 as (
  select ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  from x3
adapting/creating history table of NCS_SIE_X_CONTATTI
create table NCS_SIE_H_CONTATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
 null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTATTI_idx on NCS_SIE_H_CONTATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (CELL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (COGNOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (EMAIL varchar2(100 byte))
alter table NCS_SIE_H_CONTATTI add (FAX varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (NOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (TEL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CONTATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last
_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA fro
m NCS_SIE_V_CONTATTI where 1=0

alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTATTI modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTRATTI purge
PK     columns of NCS_SIE_X_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_X_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

PK     columns of NCS_SIE_Y_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

create or replace view NCS_SIE_V_CONTRATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_X_CONTRATTI

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_Y_CONTRATTI

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADEN
ZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA
_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,
VIA_FILIALE, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCA
DENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIF
ICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,V
IA,VIA_FILIALE

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_I
NIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOM
E_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_O
RDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE

  from x3
adapting/creating history table of NCS_SIE_X_CONTRATTI
create table NCS_SIE_H_CONTRATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) no
t null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTRATTI_idx on NCS_SIE_H_CONTRATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTRATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (CONSUMO_ANNUO_STIMATO number)
alter table NCS_SIE_H_CONTRATTI add (CONTRACT_ACCOUNT varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (DATA_INIZIO_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_FINE_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_SCADENZA_SERVIZIO date)
alter table NCS_SIE_H_CONTRATTI add (FILIALE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (IBAN varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (IMPOSTE_AGEVOLATE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_DETT_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (LOC_FILIALE varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (MOD_PAGAMENTO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_BANCA varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_OFFERTA varchar2(400 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_MAIL varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_SMS varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (PIANO_TARIFFARIO varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTRATTI add (PROV_FILIALE varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPOLOGIA_UTENZA varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_OFFERTA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_ORDERITEM varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TRATTAMENTO_IVA varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA varchar2(300 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA_FILIALE varchar2(50 byte))
create table NCS_SIE_D_CONTRATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_las
t_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,D
ATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZION
E,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,T
IPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_V_CONTRATTI where 1=0

alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTRATTI modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE group are not aligned; starting alignment.
drop table NCS_SIE_D_DELEGHE purge
PK     columns of NCS_SIE_X_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_X_DELEGHE:
PK     columns of NCS_SIE_Y_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_Y_DELEGHE:
create or replace view NCS_SIE_V_DELEGHE
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_X_DELEGHE
  union all
  select 'O' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_Y_DELEGHE
  ), x2 as (
  select CODICE_CLIENTE,ID_CONTATTO, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,ID_CONTATTO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE,ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,ID_CONTATTO
  from x3
adapting/creating history table of NCS_SIE_X_DELEGHE
create table NCS_SIE_H_DELEGHE ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_DELEGHE_idx on NCS_SIE_H_DELEGHE (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_DELEGHE add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_DELEGHE add (ID_CONTATTO varchar2(15 byte))
create table NCS_SIE_D_DELEGHE nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE where 1=0

alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_DELEGHE modify (CODICE_CLIENTE not null)
alter table NCS_SIE_D_DELEGHE modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS group are not aligned; starting alignment.
drop table NCS_SIE_D_RS purge
PK     columns of NCS_SIE_X_RS: N_RS
non-PK columns of NCS_SIE_X_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
PK     columns of NCS_SIE_Y_RS: N_RS
non-PK columns of NCS_SIE_Y_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
create or replace view NCS_SIE_V_RS
    as
  with x1 as (
  select 'N' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_X_RS

  union all
  select 'O' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_Y_RS

  ), x2 as (
  select N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO, max(dml#source) as ncs_dml
_old_new

    from x1
   group by N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by N_RS) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTO
TIPO,STATO,TIPO

  from x3
adapting/creating history table of NCS_SIE_X_RS
create table NCS_SIE_H_RS ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not null
) tablespace NCSADM_DATA

comment on column NCS_SIE_H_RS.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_RS.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_RS.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_RS_idx on NCS_SIE_H_RS (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_RS add (AREA varchar2(200 byte))
alter table NCS_SIE_H_RS add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_RS add (DATA_APERTURA date)
alter table NCS_SIE_H_RS add (DATA_CHIUSURA date)
alter table NCS_SIE_H_RS add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (N_RS varchar2(256 byte))
alter table NCS_SIE_H_RS add (RS_DESCRIZIONE varchar2(4000 byte))
alter table NCS_SIE_H_RS add (SOTTOTIPO varchar2(30 byte))
alter table NCS_SIE_H_RS add (STATO varchar2(120 byte))
alter table NCS_SIE_H_RS add (TIPO varchar2(120 byte))
create table NCS_SIE_D_RS nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_type,
 cast('x' as varchar2(1 char)) as ncs_dml_old_new,N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTI
PO,STATO,TIPO from NCS_SIE_V_RS where 1=0

alter table NCS_SIE_D_RS modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_RS modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_RS modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_RS modify (N_RS not null)
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO group are not aligned; starting alignment.
drop table NCS_SIE_D_SITO purge
PK     columns of NCS_SIE_X_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_X_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

PK     columns of NCS_SIE_Y_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

create or replace view NCS_SIE_V_SITO
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_X_SITO

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_Y_SITO

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PRO
VINCIA,TENSIONE,TIPO_CONTATORE,VIA, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,
PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  from x3
adapting/creating history table of NCS_SIE_X_SITO
create table NCS_SIE_H_SITO ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not nul
l ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_SITO.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_SITO.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_SITO.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_SITO_idx on NCS_SIE_H_SITO (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_SITO add (CAP varchar2(120 byte))
alter table NCS_SIE_H_SITO add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_SITO add (CODICE_USO varchar2(200 byte))
alter table NCS_SIE_H_SITO add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_SITO add (LIVELLO_TENSIONE varchar2(200 byte))
alter table NCS_SIE_H_SITO add (MATRICOLA_CONTATORE varchar2(100 byte))
alter table NCS_SIE_H_SITO add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (NUMERO_PRESA varchar2(100 byte))
alter table NCS_SIE_H_SITO add (PDR varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POD varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POTENZA_DISPONIBILE number)
alter table NCS_SIE_H_SITO add (POTENZA_IMPEGNATA number)
alter table NCS_SIE_H_SITO add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_SITO add (TENSIONE varchar2(50 byte))
alter table NCS_SIE_H_SITO add (TIPO_CONTATORE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (VIA varchar2(300 byte))
create table NCS_SIE_D_SITO nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_typ
e, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO where 1=0

alter table NCS_SIE_D_SITO modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_SITO modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
locking stats of table NCS_SIE_D_CLIENTI
locking stats of table NCS_SIE_H_CLIENTI
locking stats of table NCS_SIE_H_CONTATTI
locking stats of table NCS_SIE_H_RS
locking stats of table NCS_SIE_D_DELEGHE
locking stats of table NCS_SIE_D_CONTATTI
locking stats of table NCS_SIE_D_CONTRATTI
locking stats of table NCS_SIE_D_RS
locking stats of table NCS_SIE_D_SITO
locking stats of table NCS_SIE_H_CONTRATTI
locking stats of table NCS_SIE_H_SITO
locking stats of table NCS_SIE_H_DELEGHE
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for MV_CAPABILITIES_TABLE
end of gather_table_stats_wrap for MV_CAPABILITIES_TABLE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI
end of gather_table_stats_wrap for NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_ATTIVAZIONI
end of gather_table_stats_wrap for NCS_ATTIVAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONFIG
end of gather_table_stats_wrap for NCS_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI
end of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BV
end of gather_table_stats_wrap for NCS_UTENTI_BV; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_FILES
end of gather_table_stats_wrap for NCS_BV_USERS_FILES; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_D_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO_SAP
end of gather_table_stats_wrap for NCS_SYNCHRO_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_SAP
end of gather_table_stats_wrap for NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_XY_TTL_CONFIG
end of gather_table_stats_wrap for NCS_XY_TTL_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_UTENTI
end of gather_table_stats_wrap for MLOG$_NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_RS
end of gather_table_stats_wrap for NCS_SIE_D_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RICERCA_BO
end of gather_table_stats_wrap for NCS_RICERCA_BO; elapsed=5 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_SITO
end of gather_table_stats_wrap for NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_X_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_X_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_RS
end of gather_table_stats_wrap for NCS_SIE_X_RS; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_SITO
end of gather_table_stats_wrap for NCS_SIE_X_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI; elapsed=2 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_RS
end of gather_table_stats_wrap for NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_SITO
end of gather_table_stats_wrap for NCS_SIE_Y_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE
end of gather_table_stats_wrap for NCS_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CLIENTI
end of gather_table_stats_wrap for NCS_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_CONTATTI_CLI

723 rows selected.

SQL> select msg from ncs_log order by id;

MSG
------------------------------------------------------------------------------------------------------------------------------------------------------
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=19/03/2010 15:40:36
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:40:39
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:42:33
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:48
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CLIENTI purge
PK     columns of NCS_SIE_X_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_X_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
PK     columns of NCS_SIE_Y_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_Y_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
create or replace view NCS_SIE_V_CLIENTI
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_X_CLIE
NTI

  union all
  select 'O' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_Y_CLIE
NTI

  ), x2 as (
  select CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE
,VIA

  from x3
adapting/creating history table of NCS_SIE_X_CLIENTI
create table NCS_SIE_H_CLIENTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CLIENTI_idx on NCS_SIE_H_CLIENTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CLIENTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CLIENTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (EMAIL varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CLIENTI add (RAGIONE_SOCIALE varchar2(100 byte))
alter table NCS_SIE_H_CLIENTI add (SEGMENTO_CLIENTE varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CLIENTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIE
NTE,VIA from NCS_SIE_V_CLIENTI where 1=0

alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CLIENTI modify (CODICE_CLIENTE not null)
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTATTI purge
PK     columns of NCS_SIE_X_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_X_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
PK     columns of NCS_SIE_Y_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_Y_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
create or replace view NCS_SIE_V_CONTATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_X_CONTATTI
  union all
  select 'O' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_Y_CONTATTI
  ), x2 as (
  select ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  from x3
adapting/creating history table of NCS_SIE_X_CONTATTI
create table NCS_SIE_H_CONTATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
 null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTATTI_idx on NCS_SIE_H_CONTATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (CELL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (COGNOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (EMAIL varchar2(100 byte))
alter table NCS_SIE_H_CONTATTI add (FAX varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (NOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (TEL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CONTATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last
_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA fro
m NCS_SIE_V_CONTATTI where 1=0

alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTATTI modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTRATTI purge
PK     columns of NCS_SIE_X_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_X_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

PK     columns of NCS_SIE_Y_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

create or replace view NCS_SIE_V_CONTRATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_X_CONTRATTI

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_Y_CONTRATTI

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADEN
ZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA
_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,
VIA_FILIALE, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCA
DENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIF
ICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,V
IA,VIA_FILIALE

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_I
NIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOM
E_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_O
RDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE

  from x3
adapting/creating history table of NCS_SIE_X_CONTRATTI
create table NCS_SIE_H_CONTRATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) no
t null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTRATTI_idx on NCS_SIE_H_CONTRATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTRATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (CONSUMO_ANNUO_STIMATO number)
alter table NCS_SIE_H_CONTRATTI add (CONTRACT_ACCOUNT varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (DATA_INIZIO_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_FINE_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_SCADENZA_SERVIZIO date)
alter table NCS_SIE_H_CONTRATTI add (FILIALE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (IBAN varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (IMPOSTE_AGEVOLATE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_DETT_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (LOC_FILIALE varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (MOD_PAGAMENTO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_BANCA varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_OFFERTA varchar2(400 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_MAIL varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_SMS varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (PIANO_TARIFFARIO varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTRATTI add (PROV_FILIALE varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPOLOGIA_UTENZA varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_OFFERTA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_ORDERITEM varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TRATTAMENTO_IVA varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA varchar2(300 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA_FILIALE varchar2(50 byte))
create table NCS_SIE_D_CONTRATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_las
t_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,D
ATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZION
E,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,T
IPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_V_CONTRATTI where 1=0

alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTRATTI modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE group are not aligned; starting alignment.
drop table NCS_SIE_D_DELEGHE purge
PK     columns of NCS_SIE_X_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_X_DELEGHE:
PK     columns of NCS_SIE_Y_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_Y_DELEGHE:
create or replace view NCS_SIE_V_DELEGHE
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_X_DELEGHE
  union all
  select 'O' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_Y_DELEGHE
  ), x2 as (
  select CODICE_CLIENTE,ID_CONTATTO, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,ID_CONTATTO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE,ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,ID_CONTATTO
  from x3
adapting/creating history table of NCS_SIE_X_DELEGHE
create table NCS_SIE_H_DELEGHE ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_DELEGHE_idx on NCS_SIE_H_DELEGHE (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_DELEGHE add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_DELEGHE add (ID_CONTATTO varchar2(15 byte))
create table NCS_SIE_D_DELEGHE nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE where 1=0

alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_DELEGHE modify (CODICE_CLIENTE not null)
alter table NCS_SIE_D_DELEGHE modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS group are not aligned; starting alignment.
drop table NCS_SIE_D_RS purge
PK     columns of NCS_SIE_X_RS: N_RS
non-PK columns of NCS_SIE_X_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
PK     columns of NCS_SIE_Y_RS: N_RS
non-PK columns of NCS_SIE_Y_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
create or replace view NCS_SIE_V_RS
    as
  with x1 as (
  select 'N' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_X_RS

  union all
  select 'O' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_Y_RS

  ), x2 as (
  select N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO, max(dml#source) as ncs_dml
_old_new

    from x1
   group by N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by N_RS) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTO
TIPO,STATO,TIPO

  from x3
adapting/creating history table of NCS_SIE_X_RS
create table NCS_SIE_H_RS ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not null
) tablespace NCSADM_DATA

comment on column NCS_SIE_H_RS.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_RS.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_RS.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_RS_idx on NCS_SIE_H_RS (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_RS add (AREA varchar2(200 byte))
alter table NCS_SIE_H_RS add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_RS add (DATA_APERTURA date)
alter table NCS_SIE_H_RS add (DATA_CHIUSURA date)
alter table NCS_SIE_H_RS add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (N_RS varchar2(256 byte))
alter table NCS_SIE_H_RS add (RS_DESCRIZIONE varchar2(4000 byte))
alter table NCS_SIE_H_RS add (SOTTOTIPO varchar2(30 byte))
alter table NCS_SIE_H_RS add (STATO varchar2(120 byte))
alter table NCS_SIE_H_RS add (TIPO varchar2(120 byte))
create table NCS_SIE_D_RS nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_type,
 cast('x' as varchar2(1 char)) as ncs_dml_old_new,N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTI
PO,STATO,TIPO from NCS_SIE_V_RS where 1=0

alter table NCS_SIE_D_RS modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_RS modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_RS modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_RS modify (N_RS not null)
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO group are not aligned; starting alignment.
drop table NCS_SIE_D_SITO purge
PK     columns of NCS_SIE_X_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_X_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

PK     columns of NCS_SIE_Y_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

create or replace view NCS_SIE_V_SITO
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_X_SITO

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_Y_SITO

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PRO
VINCIA,TENSIONE,TIPO_CONTATORE,VIA, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,
PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  from x3
adapting/creating history table of NCS_SIE_X_SITO
create table NCS_SIE_H_SITO ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not nul
l ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_SITO.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_SITO.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_SITO.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_SITO_idx on NCS_SIE_H_SITO (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_SITO add (CAP varchar2(120 byte))
alter table NCS_SIE_H_SITO add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_SITO add (CODICE_USO varchar2(200 byte))
alter table NCS_SIE_H_SITO add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_SITO add (LIVELLO_TENSIONE varchar2(200 byte))
alter table NCS_SIE_H_SITO add (MATRICOLA_CONTATORE varchar2(100 byte))
alter table NCS_SIE_H_SITO add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (NUMERO_PRESA varchar2(100 byte))
alter table NCS_SIE_H_SITO add (PDR varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POD varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POTENZA_DISPONIBILE number)
alter table NCS_SIE_H_SITO add (POTENZA_IMPEGNATA number)
alter table NCS_SIE_H_SITO add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_SITO add (TENSIONE varchar2(50 byte))
alter table NCS_SIE_H_SITO add (TIPO_CONTATORE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (VIA varchar2(300 byte))
create table NCS_SIE_D_SITO nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_typ
e, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO where 1=0

alter table NCS_SIE_D_SITO modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_SITO modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
locking stats of table NCS_SIE_D_CLIENTI
locking stats of table NCS_SIE_H_CLIENTI
locking stats of table NCS_SIE_H_CONTATTI
locking stats of table NCS_SIE_H_RS
locking stats of table NCS_SIE_D_DELEGHE
locking stats of table NCS_SIE_D_CONTATTI
locking stats of table NCS_SIE_D_CONTRATTI
locking stats of table NCS_SIE_D_RS
locking stats of table NCS_SIE_D_SITO
locking stats of table NCS_SIE_H_CONTRATTI
locking stats of table NCS_SIE_H_SITO
locking stats of table NCS_SIE_H_DELEGHE
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for MV_CAPABILITIES_TABLE
end of gather_table_stats_wrap for MV_CAPABILITIES_TABLE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI
end of gather_table_stats_wrap for NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_ATTIVAZIONI
end of gather_table_stats_wrap for NCS_ATTIVAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONFIG
end of gather_table_stats_wrap for NCS_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI
end of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BV
end of gather_table_stats_wrap for NCS_UTENTI_BV; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_FILES
end of gather_table_stats_wrap for NCS_BV_USERS_FILES; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_D_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO_SAP
end of gather_table_stats_wrap for NCS_SYNCHRO_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_SAP
end of gather_table_stats_wrap for NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_XY_TTL_CONFIG
end of gather_table_stats_wrap for NCS_XY_TTL_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_UTENTI
end of gather_table_stats_wrap for MLOG$_NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_RS
end of gather_table_stats_wrap for NCS_SIE_D_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RICERCA_BO
end of gather_table_stats_wrap for NCS_RICERCA_BO; elapsed=5 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_SITO
end of gather_table_stats_wrap for NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_X_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_X_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_RS
end of gather_table_stats_wrap for NCS_SIE_X_RS; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_SITO
end of gather_table_stats_wrap for NCS_SIE_X_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI; elapsed=2 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_RS
end of gather_table_stats_wrap for NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_SITO
end of gather_table_stats_wrap for NCS_SIE_Y_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE
end of gather_table_stats_wrap for NCS_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CLIENTI
end of gather_table_stats_wrap for NCS_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_CONTATTI_CLI
end of gather_table_stats_wrap for NCS_DELEGHE_CONTATTI_CLI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI1
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI1; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI
end of gather_table_stats_wrap for NCS_CONTATTI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTRATTI
end of gather_table_stats_wrap for NCS_CONTRATTI; elapsed=2 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RS
end of gather_table_stats_wrap for NCS_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SITO
end of gather_table_stats_wrap for NCS_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_H_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_D_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_H_CONTATTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_D_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_D_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_H_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_D_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_H_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_H_RS
end of gather_table_stats_wrap for NCS_SIE_H_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_SITO
end of gather_table_stats_wrap for NCS_SIE_H_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_SITO
end of gather_table_stats_wrap for NCS_SIE_D_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_EXT
skipping external table NCS_BV_USERS_EXT
start of gather_table_stats_wrap for NCS_DIR_LIST_TEMP
end of gather_table_stats_wrap for NCS_DIR_LIST_TEMP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_STATI_UTENTE
end of gather_table_stats_wrap for NCS_STATI_UTENTE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RS_MESSAGGI
end of gather_table_stats_wrap for NCS_RS_MESSAGGI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RUOLI_BO
end of gather_table_stats_wrap for NCS_RUOLI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_LABEL_CONTRATTI
end of gather_table_stats_wrap for NCS_LABEL_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_STATI_ORDINE
end of gather_table_stats_wrap for NCS_STATI_ORDINE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_OPERAZIONI
end of gather_table_stats_wrap for NCS_OPERAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_GRUPPI
end of gather_table_stats_wrap for NCS_GRUPPI; elapsed=.9 sec
end of perform_statistics
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:49
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI are aligned.
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI are aligned.
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI are aligned.
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE are aligned.
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS are aligned.
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO are aligned.
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB

967 rows selected.

SQL> select msg from ncs_log order by id;

MSG
------------------------------------------------------------------------------------------------------------------------------------------------------
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=19/03/2010 15:40:36
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:40:39
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:42:33
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:48
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CLIENTI purge
PK     columns of NCS_SIE_X_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_X_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
PK     columns of NCS_SIE_Y_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_Y_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
create or replace view NCS_SIE_V_CLIENTI
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_X_CLIE
NTI

  union all
  select 'O' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_Y_CLIE
NTI

  ), x2 as (
  select CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE
,VIA

  from x3
adapting/creating history table of NCS_SIE_X_CLIENTI
create table NCS_SIE_H_CLIENTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CLIENTI_idx on NCS_SIE_H_CLIENTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CLIENTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CLIENTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (EMAIL varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CLIENTI add (RAGIONE_SOCIALE varchar2(100 byte))
alter table NCS_SIE_H_CLIENTI add (SEGMENTO_CLIENTE varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CLIENTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIE
NTE,VIA from NCS_SIE_V_CLIENTI where 1=0

alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CLIENTI modify (CODICE_CLIENTE not null)
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTATTI purge
PK     columns of NCS_SIE_X_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_X_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
PK     columns of NCS_SIE_Y_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_Y_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
create or replace view NCS_SIE_V_CONTATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_X_CONTATTI
  union all
  select 'O' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_Y_CONTATTI
  ), x2 as (
  select ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  from x3
adapting/creating history table of NCS_SIE_X_CONTATTI
create table NCS_SIE_H_CONTATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
 null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTATTI_idx on NCS_SIE_H_CONTATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (CELL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (COGNOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (EMAIL varchar2(100 byte))
alter table NCS_SIE_H_CONTATTI add (FAX varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (NOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (TEL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CONTATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last
_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA fro
m NCS_SIE_V_CONTATTI where 1=0

alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTATTI modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTRATTI purge
PK     columns of NCS_SIE_X_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_X_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

PK     columns of NCS_SIE_Y_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

create or replace view NCS_SIE_V_CONTRATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_X_CONTRATTI

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_Y_CONTRATTI

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADEN
ZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA
_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,
VIA_FILIALE, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCA
DENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIF
ICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,V
IA,VIA_FILIALE

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_I
NIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOM
E_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_O
RDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE

  from x3
adapting/creating history table of NCS_SIE_X_CONTRATTI
create table NCS_SIE_H_CONTRATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) no
t null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTRATTI_idx on NCS_SIE_H_CONTRATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTRATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (CONSUMO_ANNUO_STIMATO number)
alter table NCS_SIE_H_CONTRATTI add (CONTRACT_ACCOUNT varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (DATA_INIZIO_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_FINE_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_SCADENZA_SERVIZIO date)
alter table NCS_SIE_H_CONTRATTI add (FILIALE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (IBAN varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (IMPOSTE_AGEVOLATE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_DETT_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (LOC_FILIALE varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (MOD_PAGAMENTO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_BANCA varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_OFFERTA varchar2(400 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_MAIL varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_SMS varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (PIANO_TARIFFARIO varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTRATTI add (PROV_FILIALE varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPOLOGIA_UTENZA varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_OFFERTA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_ORDERITEM varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TRATTAMENTO_IVA varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA varchar2(300 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA_FILIALE varchar2(50 byte))
create table NCS_SIE_D_CONTRATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_las
t_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,D
ATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZION
E,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,T
IPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_V_CONTRATTI where 1=0

alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTRATTI modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE group are not aligned; starting alignment.
drop table NCS_SIE_D_DELEGHE purge
PK     columns of NCS_SIE_X_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_X_DELEGHE:
PK     columns of NCS_SIE_Y_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_Y_DELEGHE:
create or replace view NCS_SIE_V_DELEGHE
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_X_DELEGHE
  union all
  select 'O' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_Y_DELEGHE
  ), x2 as (
  select CODICE_CLIENTE,ID_CONTATTO, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,ID_CONTATTO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE,ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,ID_CONTATTO
  from x3
adapting/creating history table of NCS_SIE_X_DELEGHE
create table NCS_SIE_H_DELEGHE ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_DELEGHE_idx on NCS_SIE_H_DELEGHE (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_DELEGHE add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_DELEGHE add (ID_CONTATTO varchar2(15 byte))
create table NCS_SIE_D_DELEGHE nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE where 1=0

alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_DELEGHE modify (CODICE_CLIENTE not null)
alter table NCS_SIE_D_DELEGHE modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS group are not aligned; starting alignment.
drop table NCS_SIE_D_RS purge
PK     columns of NCS_SIE_X_RS: N_RS
non-PK columns of NCS_SIE_X_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
PK     columns of NCS_SIE_Y_RS: N_RS
non-PK columns of NCS_SIE_Y_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
create or replace view NCS_SIE_V_RS
    as
  with x1 as (
  select 'N' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_X_RS

  union all
  select 'O' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_Y_RS

  ), x2 as (
  select N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO, max(dml#source) as ncs_dml
_old_new

    from x1
   group by N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by N_RS) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTO
TIPO,STATO,TIPO

  from x3
adapting/creating history table of NCS_SIE_X_RS
create table NCS_SIE_H_RS ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not null
) tablespace NCSADM_DATA

comment on column NCS_SIE_H_RS.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_RS.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_RS.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_RS_idx on NCS_SIE_H_RS (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_RS add (AREA varchar2(200 byte))
alter table NCS_SIE_H_RS add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_RS add (DATA_APERTURA date)
alter table NCS_SIE_H_RS add (DATA_CHIUSURA date)
alter table NCS_SIE_H_RS add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (N_RS varchar2(256 byte))
alter table NCS_SIE_H_RS add (RS_DESCRIZIONE varchar2(4000 byte))
alter table NCS_SIE_H_RS add (SOTTOTIPO varchar2(30 byte))
alter table NCS_SIE_H_RS add (STATO varchar2(120 byte))
alter table NCS_SIE_H_RS add (TIPO varchar2(120 byte))
create table NCS_SIE_D_RS nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_type,
 cast('x' as varchar2(1 char)) as ncs_dml_old_new,N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTI
PO,STATO,TIPO from NCS_SIE_V_RS where 1=0

alter table NCS_SIE_D_RS modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_RS modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_RS modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_RS modify (N_RS not null)
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO group are not aligned; starting alignment.
drop table NCS_SIE_D_SITO purge
PK     columns of NCS_SIE_X_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_X_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

PK     columns of NCS_SIE_Y_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

create or replace view NCS_SIE_V_SITO
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_X_SITO

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_Y_SITO

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PRO
VINCIA,TENSIONE,TIPO_CONTATORE,VIA, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,
PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  from x3
adapting/creating history table of NCS_SIE_X_SITO
create table NCS_SIE_H_SITO ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not nul
l ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_SITO.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_SITO.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_SITO.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_SITO_idx on NCS_SIE_H_SITO (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_SITO add (CAP varchar2(120 byte))
alter table NCS_SIE_H_SITO add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_SITO add (CODICE_USO varchar2(200 byte))
alter table NCS_SIE_H_SITO add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_SITO add (LIVELLO_TENSIONE varchar2(200 byte))
alter table NCS_SIE_H_SITO add (MATRICOLA_CONTATORE varchar2(100 byte))
alter table NCS_SIE_H_SITO add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (NUMERO_PRESA varchar2(100 byte))
alter table NCS_SIE_H_SITO add (PDR varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POD varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POTENZA_DISPONIBILE number)
alter table NCS_SIE_H_SITO add (POTENZA_IMPEGNATA number)
alter table NCS_SIE_H_SITO add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_SITO add (TENSIONE varchar2(50 byte))
alter table NCS_SIE_H_SITO add (TIPO_CONTATORE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (VIA varchar2(300 byte))
create table NCS_SIE_D_SITO nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_typ
e, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO where 1=0

alter table NCS_SIE_D_SITO modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_SITO modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
locking stats of table NCS_SIE_D_CLIENTI
locking stats of table NCS_SIE_H_CLIENTI
locking stats of table NCS_SIE_H_CONTATTI
locking stats of table NCS_SIE_H_RS
locking stats of table NCS_SIE_D_DELEGHE
locking stats of table NCS_SIE_D_CONTATTI
locking stats of table NCS_SIE_D_CONTRATTI
locking stats of table NCS_SIE_D_RS
locking stats of table NCS_SIE_D_SITO
locking stats of table NCS_SIE_H_CONTRATTI
locking stats of table NCS_SIE_H_SITO
locking stats of table NCS_SIE_H_DELEGHE
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for MV_CAPABILITIES_TABLE
end of gather_table_stats_wrap for MV_CAPABILITIES_TABLE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI
end of gather_table_stats_wrap for NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_ATTIVAZIONI
end of gather_table_stats_wrap for NCS_ATTIVAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONFIG
end of gather_table_stats_wrap for NCS_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI
end of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BV
end of gather_table_stats_wrap for NCS_UTENTI_BV; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_FILES
end of gather_table_stats_wrap for NCS_BV_USERS_FILES; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_D_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO_SAP
end of gather_table_stats_wrap for NCS_SYNCHRO_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_SAP
end of gather_table_stats_wrap for NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_XY_TTL_CONFIG
end of gather_table_stats_wrap for NCS_XY_TTL_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_UTENTI
end of gather_table_stats_wrap for MLOG$_NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_RS
end of gather_table_stats_wrap for NCS_SIE_D_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RICERCA_BO
end of gather_table_stats_wrap for NCS_RICERCA_BO; elapsed=5 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_SITO
end of gather_table_stats_wrap for NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_X_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_X_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_RS
end of gather_table_stats_wrap for NCS_SIE_X_RS; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_SITO
end of gather_table_stats_wrap for NCS_SIE_X_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI; elapsed=2 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_RS
end of gather_table_stats_wrap for NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_SITO
end of gather_table_stats_wrap for NCS_SIE_Y_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE
end of gather_table_stats_wrap for NCS_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CLIENTI
end of gather_table_stats_wrap for NCS_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_CONTATTI_CLI
end of gather_table_stats_wrap for NCS_DELEGHE_CONTATTI_CLI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI1
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI1; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI
end of gather_table_stats_wrap for NCS_CONTATTI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTRATTI
end of gather_table_stats_wrap for NCS_CONTRATTI; elapsed=2 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RS
end of gather_table_stats_wrap for NCS_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SITO
end of gather_table_stats_wrap for NCS_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_H_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_D_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_H_CONTATTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_D_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_D_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_H_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_D_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_H_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_H_RS
end of gather_table_stats_wrap for NCS_SIE_H_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_SITO
end of gather_table_stats_wrap for NCS_SIE_H_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_SITO
end of gather_table_stats_wrap for NCS_SIE_D_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_EXT
skipping external table NCS_BV_USERS_EXT
start of gather_table_stats_wrap for NCS_DIR_LIST_TEMP
end of gather_table_stats_wrap for NCS_DIR_LIST_TEMP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_STATI_UTENTE
end of gather_table_stats_wrap for NCS_STATI_UTENTE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RS_MESSAGGI
end of gather_table_stats_wrap for NCS_RS_MESSAGGI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RUOLI_BO
end of gather_table_stats_wrap for NCS_RUOLI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_LABEL_CONTRATTI
end of gather_table_stats_wrap for NCS_LABEL_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_STATI_ORDINE
end of gather_table_stats_wrap for NCS_STATI_ORDINE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_OPERAZIONI
end of gather_table_stats_wrap for NCS_OPERAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_GRUPPI
end of gather_table_stats_wrap for NCS_GRUPPI; elapsed=.9 sec
end of perform_statistics
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:49
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI are aligned.
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI are aligned.
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI are aligned.
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE are aligned.
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS are aligned.
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO are aligned.
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for MV_CAPABILITIES_TABLE
end of gather_table_stats_wrap for MV_CAPABILITIES_TABLE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI
end of gather_table_stats_wrap for NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_ATTIVAZIONI
end of gather_table_stats_wrap for NCS_ATTIVAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONFIG
end of gather_table_stats_wrap for NCS_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI
end of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BV
end of gather_table_stats_wrap for NCS_UTENTI_BV; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_BV_USERS_FILES
end of gather_table_stats_wrap for NCS_BV_USERS_FILES; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_D_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO_SAP
end of gather_table_stats_wrap for NCS_SYNCHRO_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_SAP
end of gather_table_stats_wrap for NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB

1011 rows selected.

SQL> select msg from ncs_log order by id;

MSG
------------------------------------------------------------------------------------------------------------------------------------------------------
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=19/03/2010 15:40:36
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:40:39
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:42:33
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:48
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CLIENTI purge
PK     columns of NCS_SIE_X_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_X_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
PK     columns of NCS_SIE_Y_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_Y_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
create or replace view NCS_SIE_V_CLIENTI
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_X_CLIE
NTI

  union all
  select 'O' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_Y_CLIE
NTI

  ), x2 as (
  select CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE
,VIA

  from x3
adapting/creating history table of NCS_SIE_X_CLIENTI
create table NCS_SIE_H_CLIENTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CLIENTI_idx on NCS_SIE_H_CLIENTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CLIENTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CLIENTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (EMAIL varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CLIENTI add (RAGIONE_SOCIALE varchar2(100 byte))
alter table NCS_SIE_H_CLIENTI add (SEGMENTO_CLIENTE varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CLIENTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIE
NTE,VIA from NCS_SIE_V_CLIENTI where 1=0

alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CLIENTI modify (CODICE_CLIENTE not null)
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTATTI purge
PK     columns of NCS_SIE_X_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_X_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
PK     columns of NCS_SIE_Y_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_Y_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
create or replace view NCS_SIE_V_CONTATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_X_CONTATTI
  union all
  select 'O' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_Y_CONTATTI
  ), x2 as (
  select ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  from x3
adapting/creating history table of NCS_SIE_X_CONTATTI
create table NCS_SIE_H_CONTATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
 null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTATTI_idx on NCS_SIE_H_CONTATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (CELL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (COGNOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (EMAIL varchar2(100 byte))
alter table NCS_SIE_H_CONTATTI add (FAX varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (NOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (TEL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CONTATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last
_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA fro
m NCS_SIE_V_CONTATTI where 1=0

alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTATTI modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTRATTI purge
PK     columns of NCS_SIE_X_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_X_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

PK     columns of NCS_SIE_Y_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

create or replace view NCS_SIE_V_CONTRATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_X_CONTRATTI

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_Y_CONTRATTI

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADEN
ZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA
_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,
VIA_FILIALE, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCA
DENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIF
ICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,V
IA,VIA_FILIALE

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_I
NIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOM
E_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_O
RDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE

  from x3
adapting/creating history table of NCS_SIE_X_CONTRATTI
create table NCS_SIE_H_CONTRATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) no
t null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTRATTI_idx on NCS_SIE_H_CONTRATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTRATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (CONSUMO_ANNUO_STIMATO number)
alter table NCS_SIE_H_CONTRATTI add (CONTRACT_ACCOUNT varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (DATA_INIZIO_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_FINE_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_SCADENZA_SERVIZIO date)
alter table NCS_SIE_H_CONTRATTI add (FILIALE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (IBAN varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (IMPOSTE_AGEVOLATE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_DETT_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (LOC_FILIALE varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (MOD_PAGAMENTO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_BANCA varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_OFFERTA varchar2(400 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_MAIL varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_SMS varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (PIANO_TARIFFARIO varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTRATTI add (PROV_FILIALE varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPOLOGIA_UTENZA varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_OFFERTA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_ORDERITEM varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TRATTAMENTO_IVA varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA varchar2(300 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA_FILIALE varchar2(50 byte))
create table NCS_SIE_D_CONTRATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_las
t_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,D
ATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZION
E,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,T
IPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_V_CONTRATTI where 1=0

alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTRATTI modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE group are not aligned; starting alignment.
drop table NCS_SIE_D_DELEGHE purge
PK     columns of NCS_SIE_X_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_X_DELEGHE:
PK     columns of NCS_SIE_Y_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_Y_DELEGHE:
create or replace view NCS_SIE_V_DELEGHE
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_X_DELEGHE
  union all
  select 'O' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_Y_DELEGHE
  ), x2 as (
  select CODICE_CLIENTE,ID_CONTATTO, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,ID_CONTATTO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE,ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,ID_CONTATTO
  from x3
adapting/creating history table of NCS_SIE_X_DELEGHE
create table NCS_SIE_H_DELEGHE ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_DELEGHE_idx on NCS_SIE_H_DELEGHE (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_DELEGHE add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_DELEGHE add (ID_CONTATTO varchar2(15 byte))
create table NCS_SIE_D_DELEGHE nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE where 1=0

alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_DELEGHE modify (CODICE_CLIENTE not null)
alter table NCS_SIE_D_DELEGHE modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS group are not aligned; starting alignment.
drop table NCS_SIE_D_RS purge
PK     columns of NCS_SIE_X_RS: N_RS
non-PK columns of NCS_SIE_X_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
PK     columns of NCS_SIE_Y_RS: N_RS
non-PK columns of NCS_SIE_Y_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
create or replace view NCS_SIE_V_RS
    as
  with x1 as (
  select 'N' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_X_RS

  union all
  select 'O' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_Y_RS

  ), x2 as (
  select N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO, max(dml#source) as ncs_dml
_old_new

    from x1
   group by N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by N_RS) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTO
TIPO,STATO,TIPO

  from x3
adapting/creating history table of NCS_SIE_X_RS
create table NCS_SIE_H_RS ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not null
) tablespace NCSADM_DATA

comment on column NCS_SIE_H_RS.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_RS.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_RS.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_RS_idx on NCS_SIE_H_RS (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_RS add (AREA varchar2(200 byte))
alter table NCS_SIE_H_RS add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_RS add (DATA_APERTURA date)
alter table NCS_SIE_H_RS add (DATA_CHIUSURA date)
alter table NCS_SIE_H_RS add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (N_RS varchar2(256 byte))
alter table NCS_SIE_H_RS add (RS_DESCRIZIONE varchar2(4000 byte))
alter table NCS_SIE_H_RS add (SOTTOTIPO varchar2(30 byte))
alter table NCS_SIE_H_RS add (STATO varchar2(120 byte))
alter table NCS_SIE_H_RS add (TIPO varchar2(120 byte))
create table NCS_SIE_D_RS nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_type,
 cast('x' as varchar2(1 char)) as ncs_dml_old_new,N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTI
PO,STATO,TIPO from NCS_SIE_V_RS where 1=0

alter table NCS_SIE_D_RS modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_RS modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_RS modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_RS modify (N_RS not null)
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO group are not aligned; starting alignment.
drop table NCS_SIE_D_SITO purge
PK     columns of NCS_SIE_X_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_X_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

PK     columns of NCS_SIE_Y_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

create or replace view NCS_SIE_V_SITO
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_X_SITO

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_Y_SITO

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PRO
VINCIA,TENSIONE,TIPO_CONTATORE,VIA, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,
PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  from x3
adapting/creating history table of NCS_SIE_X_SITO
create table NCS_SIE_H_SITO ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not nul
l ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_SITO.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_SITO.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_SITO.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_SITO_idx on NCS_SIE_H_SITO (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_SITO add (CAP varchar2(120 byte))
alter table NCS_SIE_H_SITO add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_SITO add (CODICE_USO varchar2(200 byte))
alter table NCS_SIE_H_SITO add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_SITO add (LIVELLO_TENSIONE varchar2(200 byte))
alter table NCS_SIE_H_SITO add (MATRICOLA_CONTATORE varchar2(100 byte))
alter table NCS_SIE_H_SITO add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (NUMERO_PRESA varchar2(100 byte))
alter table NCS_SIE_H_SITO add (PDR varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POD varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POTENZA_DISPONIBILE number)
alter table NCS_SIE_H_SITO add (POTENZA_IMPEGNATA number)
alter table NCS_SIE_H_SITO add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_SITO add (TENSIONE varchar2(50 byte))
alter table NCS_SIE_H_SITO add (TIPO_CONTATORE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (VIA varchar2(300 byte))
create table NCS_SIE_D_SITO nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_typ
e, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO where 1=0

alter table NCS_SIE_D_SITO modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_SITO modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
locking stats of table NCS_SIE_D_CLIENTI
locking stats of table NCS_SIE_H_CLIENTI
locking stats of table NCS_SIE_H_CONTATTI
locking stats of table NCS_SIE_H_RS
locking stats of table NCS_SIE_D_DELEGHE
locking stats of table NCS_SIE_D_CONTATTI
locking stats of table NCS_SIE_D_CONTRATTI
locking stats of table NCS_SIE_D_RS
locking stats of table NCS_SIE_D_SITO
locking stats of table NCS_SIE_H_CONTRATTI
locking stats of table NCS_SIE_H_SITO
locking stats of table NCS_SIE_H_DELEGHE
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for MV_CAPABILITIES_TABLE
end of gather_table_stats_wrap for MV_CAPABILITIES_TABLE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI
end of gather_table_stats_wrap for NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_ATTIVAZIONI
end of gather_table_stats_wrap for NCS_ATTIVAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONFIG
end of gather_table_stats_wrap for NCS_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI
end of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BV
end of gather_table_stats_wrap for NCS_UTENTI_BV; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_FILES
end of gather_table_stats_wrap for NCS_BV_USERS_FILES; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_D_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO_SAP
end of gather_table_stats_wrap for NCS_SYNCHRO_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_SAP
end of gather_table_stats_wrap for NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_XY_TTL_CONFIG
end of gather_table_stats_wrap for NCS_XY_TTL_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_UTENTI
end of gather_table_stats_wrap for MLOG$_NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_RS
end of gather_table_stats_wrap for NCS_SIE_D_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RICERCA_BO
end of gather_table_stats_wrap for NCS_RICERCA_BO; elapsed=5 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_SITO
end of gather_table_stats_wrap for NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_X_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_X_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_RS
end of gather_table_stats_wrap for NCS_SIE_X_RS; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_SITO
end of gather_table_stats_wrap for NCS_SIE_X_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI; elapsed=2 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_RS
end of gather_table_stats_wrap for NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_SITO
end of gather_table_stats_wrap for NCS_SIE_Y_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE
end of gather_table_stats_wrap for NCS_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CLIENTI
end of gather_table_stats_wrap for NCS_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_CONTATTI_CLI
end of gather_table_stats_wrap for NCS_DELEGHE_CONTATTI_CLI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI1
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI1; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI
end of gather_table_stats_wrap for NCS_CONTATTI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTRATTI
end of gather_table_stats_wrap for NCS_CONTRATTI; elapsed=2 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RS
end of gather_table_stats_wrap for NCS_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SITO
end of gather_table_stats_wrap for NCS_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_H_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_D_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_H_CONTATTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_D_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_D_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_H_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_D_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_H_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_H_RS
end of gather_table_stats_wrap for NCS_SIE_H_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_SITO
end of gather_table_stats_wrap for NCS_SIE_H_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_SITO
end of gather_table_stats_wrap for NCS_SIE_D_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_EXT
skipping external table NCS_BV_USERS_EXT
start of gather_table_stats_wrap for NCS_DIR_LIST_TEMP
end of gather_table_stats_wrap for NCS_DIR_LIST_TEMP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_STATI_UTENTE
end of gather_table_stats_wrap for NCS_STATI_UTENTE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RS_MESSAGGI
end of gather_table_stats_wrap for NCS_RS_MESSAGGI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RUOLI_BO
end of gather_table_stats_wrap for NCS_RUOLI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_LABEL_CONTRATTI
end of gather_table_stats_wrap for NCS_LABEL_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_STATI_ORDINE
end of gather_table_stats_wrap for NCS_STATI_ORDINE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_OPERAZIONI
end of gather_table_stats_wrap for NCS_OPERAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_GRUPPI
end of gather_table_stats_wrap for NCS_GRUPPI; elapsed=.9 sec
end of perform_statistics
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:49
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI are aligned.
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI are aligned.
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI are aligned.
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE are aligned.
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS are aligned.
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO are aligned.
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for MV_CAPABILITIES_TABLE
end of gather_table_stats_wrap for MV_CAPABILITIES_TABLE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI
end of gather_table_stats_wrap for NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_ATTIVAZIONI
end of gather_table_stats_wrap for NCS_ATTIVAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONFIG
end of gather_table_stats_wrap for NCS_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI
end of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BV
end of gather_table_stats_wrap for NCS_UTENTI_BV; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_BV_USERS_FILES
end of gather_table_stats_wrap for NCS_BV_USERS_FILES; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_D_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO_SAP
end of gather_table_stats_wrap for NCS_SYNCHRO_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_SAP
end of gather_table_stats_wrap for NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_XY_TTL_CONFIG
end of gather_table_stats_wrap for NCS_XY_TTL_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_UTENTI
end of gather_table_stats_wrap for MLOG$_NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_RS
end of gather_table_stats_wrap for NCS_SIE_D_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RICERCA_BO
end of gather_table_stats_wrap for NCS_RICERCA_BO; elapsed=5 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI

1025 rows selected.

SQL> select msg from ncs_log order by id;

MSG
------------------------------------------------------------------------------------------------------------------------------------------------------
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=19/03/2010 15:40:36
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:40:39
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:42:33
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_x_clienti,ncs_x_contatti,ncs_x_contratti,ncs_x_deleghe,ncs_x_rs,ncs_x_sito
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
siebel staging area unlocked
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:48
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CLIENTI purge
PK     columns of NCS_SIE_X_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_X_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
PK     columns of NCS_SIE_Y_CLIENTI: CODICE_CLIENTE
non-PK columns of NCS_SIE_Y_CLIENTI: CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
create or replace view NCS_SIE_V_CLIENTI
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_X_CLIE
NTI

  union all
  select 'O' as dml#source, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_Y_CLIE
NTI

  ), x2 as (
  select CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE
,VIA

  from x3
adapting/creating history table of NCS_SIE_X_CLIENTI
create table NCS_SIE_H_CLIENTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CLIENTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CLIENTI_idx on NCS_SIE_H_CLIENTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CLIENTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CLIENTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (EMAIL varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CLIENTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CLIENTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CLIENTI add (RAGIONE_SOCIALE varchar2(100 byte))
alter table NCS_SIE_H_CLIENTI add (SEGMENTO_CLIENTE varchar2(50 byte))
alter table NCS_SIE_H_CLIENTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CLIENTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIE
NTE,VIA from NCS_SIE_V_CLIENTI where 1=0

alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CLIENTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CLIENTI modify (CODICE_CLIENTE not null)
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTATTI purge
PK     columns of NCS_SIE_X_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_X_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
PK     columns of NCS_SIE_Y_CONTATTI: ID_CONTATTO
non-PK columns of NCS_SIE_Y_CONTATTI: CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
create or replace view NCS_SIE_V_CONTATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_X_CONTATTI
  union all
  select 'O' as dml#source, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_Y_CONTATTI
  ), x2 as (
  select ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA, max(dml#source) as ncs_dml_old_new
    from x1
   group by ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
  from x3
adapting/creating history table of NCS_SIE_X_CONTATTI
create table NCS_SIE_H_CONTATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
 null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTATTI_idx on NCS_SIE_H_CONTATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (CELL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (COGNOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (EMAIL varchar2(100 byte))
alter table NCS_SIE_H_CONTATTI add (FAX varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTATTI add (NOME varchar2(50 byte))
alter table NCS_SIE_H_CONTATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (TEL varchar2(40 byte))
alter table NCS_SIE_H_CONTATTI add (VIA varchar2(300 byte))
create table NCS_SIE_D_CONTATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last
_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA fro
m NCS_SIE_V_CONTATTI where 1=0

alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTATTI modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI group are not aligned; starting alignment.
drop table NCS_SIE_D_CONTRATTI purge
PK     columns of NCS_SIE_X_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_X_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

PK     columns of NCS_SIE_Y_CONTRATTI: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_CONTRATTI: CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FO
RNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIF
ICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRA
TTAMENTO_IVA,VIA,VIA_FILIALE

create or replace view NCS_SIE_V_CONTRATTI
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_X_CONTRATTI

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_
FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOT
IFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,T
RATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_Y_CONTRATTI

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADEN
ZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA
_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,
VIA_FILIALE, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCA
DENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIF
ICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,V
IA,VIA_FILIALE

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_I
NIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOM
E_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_O
RDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE

  from x3
adapting/creating history table of NCS_SIE_X_CONTRATTI
create table NCS_SIE_H_CONTRATTI ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) no
t null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_CONTRATTI.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_CONTRATTI_idx on NCS_SIE_H_CONTRATTI (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_CONTRATTI add (CAP varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (CODICE_FISCALE varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (CONSUMO_ANNUO_STIMATO number)
alter table NCS_SIE_H_CONTRATTI add (CONTRACT_ACCOUNT varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (DATA_INIZIO_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_FINE_FORNITURA date)
alter table NCS_SIE_H_CONTRATTI add (DT_SCADENZA_SERVIZIO date)
alter table NCS_SIE_H_CONTRATTI add (FILIALE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (IBAN varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_CONTRATTI add (IMPOSTE_AGEVOLATE varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_DETT_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (INVIA_FATT varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (LOC_FILIALE varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (MOD_PAGAMENTO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_BANCA varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (NOME_OFFERTA varchar2(400 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_MAIL varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (NOTIFICA_SMS varchar2(1 byte))
alter table NCS_SIE_H_CONTRATTI add (PIANO_TARIFFARIO varchar2(100 byte))
alter table NCS_SIE_H_CONTRATTI add (PIVA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_CONTRATTI add (PROV_FILIALE varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (STATO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPOLOGIA_UTENZA varchar2(50 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_OFFERTA varchar2(120 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_ORDERITEM varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TIPO_SERVIZIO varchar2(30 byte))
alter table NCS_SIE_H_CONTRATTI add (TRATTAMENTO_IVA varchar2(80 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA varchar2(300 byte))
alter table NCS_SIE_H_CONTRATTI add (VIA_FILIALE varchar2(50 byte))
create table NCS_SIE_D_CONTRATTI nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_las
t_type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,D
ATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZION
E,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,T
IPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE from NCS_SIE_V_CONTRATTI where 1=0

alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_CONTRATTI modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_CONTRATTI modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE group are not aligned; starting alignment.
drop table NCS_SIE_D_DELEGHE purge
PK     columns of NCS_SIE_X_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_X_DELEGHE:
PK     columns of NCS_SIE_Y_DELEGHE: CODICE_CLIENTE,ID_CONTATTO
non-PK columns of NCS_SIE_Y_DELEGHE:
create or replace view NCS_SIE_V_DELEGHE
    as
  with x1 as (
  select 'N' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_X_DELEGHE
  union all
  select 'O' as dml#source, CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_Y_DELEGHE
  ), x2 as (
  select CODICE_CLIENTE,ID_CONTATTO, max(dml#source) as ncs_dml_old_new
    from x1
   group by CODICE_CLIENTE,ID_CONTATTO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by CODICE_CLIENTE,ID_CONTATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, CODICE_CLIENTE,ID_CONTATTO
  from x3
adapting/creating history table of NCS_SIE_X_DELEGHE
create table NCS_SIE_H_DELEGHE ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not
null ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_DELEGHE.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_DELEGHE_idx on NCS_SIE_H_DELEGHE (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_DELEGHE add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_DELEGHE add (ID_CONTATTO varchar2(15 byte))
create table NCS_SIE_D_DELEGHE nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_
type, cast('x' as varchar2(1 char)) as ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE where 1=0

alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_DELEGHE modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_DELEGHE modify (CODICE_CLIENTE not null)
alter table NCS_SIE_D_DELEGHE modify (ID_CONTATTO not null)
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS group are not aligned; starting alignment.
drop table NCS_SIE_D_RS purge
PK     columns of NCS_SIE_X_RS: N_RS
non-PK columns of NCS_SIE_X_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
PK     columns of NCS_SIE_Y_RS: N_RS
non-PK columns of NCS_SIE_Y_RS: AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
create or replace view NCS_SIE_V_RS
    as
  with x1 as (
  select 'N' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_X_RS

  union all
  select 'O' as dml#source, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS
_SIE_Y_RS

  ), x2 as (
  select N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO, max(dml#source) as ncs_dml
_old_new

    from x1
   group by N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO
  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by N_RS) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTO
TIPO,STATO,TIPO

  from x3
adapting/creating history table of NCS_SIE_X_RS
create table NCS_SIE_H_RS ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not null
) tablespace NCSADM_DATA

comment on column NCS_SIE_H_RS.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_RS.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_RS.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_RS_idx on NCS_SIE_H_RS (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_RS add (AREA varchar2(200 byte))
alter table NCS_SIE_H_RS add (CODICE_CLIENTE varchar2(15 byte))
alter table NCS_SIE_H_RS add (DATA_APERTURA date)
alter table NCS_SIE_H_RS add (DATA_CHIUSURA date)
alter table NCS_SIE_H_RS add (ID_CONTATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_RS add (N_RS varchar2(256 byte))
alter table NCS_SIE_H_RS add (RS_DESCRIZIONE varchar2(4000 byte))
alter table NCS_SIE_H_RS add (SOTTOTIPO varchar2(30 byte))
alter table NCS_SIE_H_RS add (STATO varchar2(120 byte))
alter table NCS_SIE_H_RS add (TIPO varchar2(120 byte))
create table NCS_SIE_D_RS nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_type,
 cast('x' as varchar2(1 char)) as ncs_dml_old_new,N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCRIZIONE,SOTTOTI
PO,STATO,TIPO from NCS_SIE_V_RS where 1=0

alter table NCS_SIE_D_RS modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_RS modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_RS modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_RS modify (N_RS not null)
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO group are not aligned; starting alignment.
drop table NCS_SIE_D_SITO purge
PK     columns of NCS_SIE_X_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_X_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

PK     columns of NCS_SIE_Y_SITO: ID_CONTRATTO
non-PK columns of NCS_SIE_Y_SITO: CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_I
MPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

create or replace view NCS_SIE_V_SITO
    as
  with x1 as (
  select 'N' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_X_SITO

  union all
  select 'O' as dml#source, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,PO
TENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_Y_SITO

  ), x2 as (
  select ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PRO
VINCIA,TENSIONE,TIPO_CONTATORE,VIA, max(dml#source) as ncs_dml_old_new

    from x1
   group by ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,
PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  having count(*) < 2
  ), x3 as (
    select x2.*, count(*) over(partition by ID_CONTRATTO) dml#count
      from x2
  )
  select case when dml#count = 2 then 'U'
              when dml#count = 1 and ncs_dml_old_new = 'N' then 'I'
              when dml#count = 1 and ncs_dml_old_new = 'O' then 'D'
         end as ncs_dml_last_type, ncs_dml_old_new, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA

  from x3
adapting/creating history table of NCS_SIE_X_SITO
create table NCS_SIE_H_SITO ( ncs_dml_last_date date not null, ncs_dml_last_type varchar2(1 char) not null, ncs_dml_old_new   varchar2(1 char) not nul
l ) tablespace NCSADM_DATA

comment on column NCS_SIE_H_SITO.ncs_dml_last_date is 'date of this modification propagation'
comment on column NCS_SIE_H_SITO.ncs_dml_last_type is 'I=insert,U=update,D=delete'
comment on column NCS_SIE_H_SITO.ncs_dml_old_new   is 'O=old row image,N=new row image'
create index NCS_SIE_H_SITO_idx on NCS_SIE_H_SITO (ncs_dml_last_date) compress 1 tablespace NCSADM_DATA
alter table NCS_SIE_H_SITO add (CAP varchar2(120 byte))
alter table NCS_SIE_H_SITO add (CITTA varchar2(200 byte))
alter table NCS_SIE_H_SITO add (CODICE_USO varchar2(200 byte))
alter table NCS_SIE_H_SITO add (ID_CONTRATTO varchar2(15 byte))
alter table NCS_SIE_H_SITO add (LIVELLO_TENSIONE varchar2(200 byte))
alter table NCS_SIE_H_SITO add (MATRICOLA_CONTATORE varchar2(100 byte))
alter table NCS_SIE_H_SITO add (NAZIONE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (NUMERO_PRESA varchar2(100 byte))
alter table NCS_SIE_H_SITO add (PDR varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POD varchar2(100 byte))
alter table NCS_SIE_H_SITO add (POTENZA_DISPONIBILE number)
alter table NCS_SIE_H_SITO add (POTENZA_IMPEGNATA number)
alter table NCS_SIE_H_SITO add (PROVINCIA varchar2(40 byte))
alter table NCS_SIE_H_SITO add (TENSIONE varchar2(50 byte))
alter table NCS_SIE_H_SITO add (TIPO_CONTATORE varchar2(120 byte))
alter table NCS_SIE_H_SITO add (VIA varchar2(300 byte))
create table NCS_SIE_D_SITO nologging tablespace NCSADM_DATA as select sysdate as ncs_dml_last_date, cast('x' as varchar2(1 char)) as ncs_dml_last_typ
e, cast('x' as varchar2(1 char)) as ncs_dml_old_new,ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,PO
D,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO where 1=0

alter table NCS_SIE_D_SITO modify (ncs_dml_last_date not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_last_type not null)
alter table NCS_SIE_D_SITO modify (ncs_dml_old_new   not null)
alter table NCS_SIE_D_SITO modify (ID_CONTRATTO not null)
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
locking stats of table NCS_SIE_D_CLIENTI
locking stats of table NCS_SIE_H_CLIENTI
locking stats of table NCS_SIE_H_CONTATTI
locking stats of table NCS_SIE_H_RS
locking stats of table NCS_SIE_D_DELEGHE
locking stats of table NCS_SIE_D_CONTATTI
locking stats of table NCS_SIE_D_CONTRATTI
locking stats of table NCS_SIE_D_RS
locking stats of table NCS_SIE_D_SITO
locking stats of table NCS_SIE_H_CONTRATTI
locking stats of table NCS_SIE_H_SITO
locking stats of table NCS_SIE_H_DELEGHE
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for MV_CAPABILITIES_TABLE
end of gather_table_stats_wrap for MV_CAPABILITIES_TABLE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_UTENTI
end of gather_table_stats_wrap for NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_ATTIVAZIONI
end of gather_table_stats_wrap for NCS_ATTIVAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONFIG
end of gather_table_stats_wrap for NCS_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI
end of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BV
end of gather_table_stats_wrap for NCS_UTENTI_BV; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_FILES
end of gather_table_stats_wrap for NCS_BV_USERS_FILES; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_D_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO_SAP
end of gather_table_stats_wrap for NCS_SYNCHRO_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_SAP
end of gather_table_stats_wrap for NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_XY_TTL_CONFIG
end of gather_table_stats_wrap for NCS_XY_TTL_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_UTENTI
end of gather_table_stats_wrap for MLOG$_NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_RS
end of gather_table_stats_wrap for NCS_SIE_D_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RICERCA_BO
end of gather_table_stats_wrap for NCS_RICERCA_BO; elapsed=5 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_SITO
end of gather_table_stats_wrap for NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_X_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_X_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_RS
end of gather_table_stats_wrap for NCS_SIE_X_RS; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_SITO
end of gather_table_stats_wrap for NCS_SIE_X_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI; elapsed=2 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_RS
end of gather_table_stats_wrap for NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_SITO
end of gather_table_stats_wrap for NCS_SIE_Y_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE
end of gather_table_stats_wrap for NCS_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CLIENTI
end of gather_table_stats_wrap for NCS_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_CONTATTI_CLI
end of gather_table_stats_wrap for NCS_DELEGHE_CONTATTI_CLI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI1
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI1; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI
end of gather_table_stats_wrap for NCS_CONTATTI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTRATTI
end of gather_table_stats_wrap for NCS_CONTRATTI; elapsed=2 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RS
end of gather_table_stats_wrap for NCS_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SITO
end of gather_table_stats_wrap for NCS_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_H_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_D_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_H_CONTATTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_D_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_D_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_H_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_D_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_H_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_H_RS
end of gather_table_stats_wrap for NCS_SIE_H_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_SITO
end of gather_table_stats_wrap for NCS_SIE_H_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_SITO
end of gather_table_stats_wrap for NCS_SIE_D_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_EXT
skipping external table NCS_BV_USERS_EXT
start of gather_table_stats_wrap for NCS_DIR_LIST_TEMP
end of gather_table_stats_wrap for NCS_DIR_LIST_TEMP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_STATI_UTENTE
end of gather_table_stats_wrap for NCS_STATI_UTENTE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RS_MESSAGGI
end of gather_table_stats_wrap for NCS_RS_MESSAGGI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RUOLI_BO
end of gather_table_stats_wrap for NCS_RUOLI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_LABEL_CONTRATTI
end of gather_table_stats_wrap for NCS_LABEL_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_STATI_ORDINE
end of gather_table_stats_wrap for NCS_STATI_ORDINE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_OPERAZIONI
end of gather_table_stats_wrap for NCS_OPERAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_GRUPPI
end of gather_table_stats_wrap for NCS_GRUPPI; elapsed=.9 sec
end of perform_statistics
considering log "MLOG$_NCS_CLIENTI"
considering log "MLOG$_NCS_CONTATTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI"
considering log "MLOG$_NCS_CONTATTI_CLIENTI1"
considering log "MLOG$_NCS_CONTATTI_SAP"
considering log "MLOG$_NCS_CONTRATTI"
considering log "MLOG$_NCS_DELEGHE"
considering log "MLOG$_NCS_DELEGHE_CONTATTI"
considering log "MLOG$_NCS_DELEGHE_SAP"
considering log "MLOG$_NCS_SAP_Y_CLIENTI"
considering log "MLOG$_NCS_SAP_Y_CONTRATTI"
considering log "MLOG$_NCS_SAP_Y_SITO"
considering log "MLOG$_NCS_SIE_Y_CLIENTI"
considering log "MLOG$_NCS_SIE_Y_CONTATTI"
considering log "MLOG$_NCS_SIE_Y_CONTRATTI"
considering log "MLOG$_NCS_SIE_Y_DELEGHE"
considering log "MLOG$_NCS_SIE_Y_RS"
considering log "MLOG$_NCS_SIE_Y_SITO"
considering log "MLOG$_NCS_SITO"
considering log "MLOG$_NCS_UTENTI"
new staging area image detected for siebel for LAST_UNLOCK_DATE=22/03/2010 16:43:49
start of check_staging_sanity for SIEBEL
select count(*) from STAGING_SIEBEL_CLIENTI_VIEW where rownum <= 10
STAGING_SIEBEL_CLIENTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_CONTRATTI_VIEW where rownum <= 10
STAGING_SIEBEL_CONTRATTI_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_DELEGHE_VIEW where rownum <= 10
STAGING_SIEBEL_DELEGHE_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_RS_VIEW where rownum <= 10
STAGING_SIEBEL_RS_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
select count(*) from STAGING_SIEBEL_SITO_VIEW where rownum <= 10
STAGING_SIEBEL_SITO_VIEW : cardinality ok, more than REFRESH_MIN_REMOTE_CARDINALITY=10
end of check_staging_sanity for SIEBEL
start of perform_refresh_siebel
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
siebel staging area locked
refreshing siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
end of refresh of siebel MVs: ncs_sie_x_clienti,ncs_sie_x_contatti,ncs_sie_x_contratti,ncs_sie_x_deleghe,ncs_sie_x_rs,ncs_sie_x_sito
siebel staging area unlocked
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CLIENTI group.
definitions of NCS_SIE_X_CLIENTI are aligned.
truncate table NCS_SIE_D_CLIENTI
insert /*+ append */ into NCS_SIE_D_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZI
ONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_V_CLIENTI

inserted 0 rows into D for NCS_SIE_X_CLIENTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTATTI group.
definitions of NCS_SIE_X_CONTATTI are aligned.
truncate table NCS_SIE_D_CONTATTI
insert /*+ append */ into NCS_SIE_D_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select sysdate, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_CONTATT
O,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_V_CONTATTI

inserted 0 rows into D for NCS_SIE_X_CONTATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_CONTRATTI group.
definitions of NCS_SIE_X_CONTRATTI are aligned.
truncate table NCS_SIE_D_CONTRATTI
insert /*+ append */ into NCS_SIE_D_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select sysdate, ncs_dml_last_type, ncs_dml_old
_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIA
LE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS
,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_
FILIALE from NCS_SIE_V_CONTRATTI

inserted 0 rows into D for NCS_SIE_X_CONTRATTI
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_DELEGHE group.
definitions of NCS_SIE_X_DELEGHE are aligned.
truncate table NCS_SIE_D_DELEGHE
insert /*+ append */ into NCS_SIE_D_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select sysdate, ncs_dml_
last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_V_DELEGHE

inserted 0 rows into D for NCS_SIE_X_DELEGHE
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_RS group.
definitions of NCS_SIE_X_RS are aligned.
truncate table NCS_SIE_D_RS
insert /*+ append */ into NCS_SIE_D_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select sysdate, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CH
IUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_V_RS

inserted 0 rows into D for NCS_SIE_X_RS
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
checking definitions alignment of NCS_SIE_X_SITO group.
definitions of NCS_SIE_X_SITO are aligned.
truncate table NCS_SIE_D_SITO
insert /*+ append */ into NCS_SIE_D_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select sysdate, ncs_dml_last
_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA
_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_V_SITO

inserted 0 rows into D for NCS_SIE_X_SITO
insert /*+ append */ into NCS_SIE_H_CLIENTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CONTATTO,NAZIONE,P
IVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,EMAIL,ID_CON
TATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,SEGMENTO_CLIENTE,VIA from NCS_SIE_D_CLIENTI

copied 0 rows from D to H for NCS_SIE_X_CLIENTI
delete from NCS_SIE_Y_CLIENTI where (CODICE_CLIENTE) in ( select CODICE_CLIENTE   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CLIENTI
insert into NCS_SIE_Y_CLIENTI (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE
,SEGMENTO_CLIENTE,VIA) select ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,CAP,CITTA,EMAIL,ID_CONTATTO,NAZIONE,PIVA,PROVINCIA,RAGIONE_SOCIALE,
SEGMENTO_CLIENTE,VIA   from NCS_SIE_D_CLIENTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CLIENTI
insert /*+ append */ into NCS_SIE_H_CONTATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,ID_
CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,
ID_CONTATTO,NAZIONE,NOME,PROVINCIA,TEL,VIA from NCS_SIE_D_CONTATTI

copied 0 rows from D to H for NCS_SIE_X_CONTATTI
delete from NCS_SIE_Y_CONTATTI where (ID_CONTATTO) in ( select ID_CONTATTO   from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTATTI
insert into NCS_SIE_Y_CONTATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINC
IA,TEL,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTATTO,CAP,CELL,CITTA,CODICE_FISCALE,COGNOME,EMAIL,FAX,NAZIONE,NOME,PROVINCIA,TEL,VIA
from NCS_SIE_D_CONTATTI  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTATTI
insert /*+ append */ into NCS_SIE_H_CONTRATTI(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_AN
NUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,
INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STA
TO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, n
cs_dml_old_new,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERV
IZIO,FILIALE,IBAN,ID_CONTRATTO,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NO
TIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IV
A,VIA,VIA_FILIALE from NCS_SIE_D_CONTRATTI

copied 0 rows from D to H for NCS_SIE_X_CONTRATTI
delete from NCS_SIE_Y_CONTRATTI where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_CONTRATTI  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_CONTRATTI
insert into NCS_SIE_Y_CONTRATTI (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONT
RACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOLATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PA
GAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PROV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,
TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_
CLIENTE,CODICE_FISCALE,CONSUMO_ANNUO_STIMATO,CONTRACT_ACCOUNT,DATA_INIZIO_FORNITURA,DT_FINE_FORNITURA,DT_SCADENZA_SERVIZIO,FILIALE,IBAN,IMPOSTE_AGEVOL
ATE,INVIA_DETT_FATT,INVIA_FATT,LOC_FILIALE,MOD_PAGAMENTO,NAZIONE,NOME_BANCA,NOME_OFFERTA,NOTIFICA_MAIL,NOTIFICA_SMS,PIANO_TARIFFARIO,PIVA,PROVINCIA,PR
OV_FILIALE,STATO,STATO_SERVIZIO,TIPOLOGIA_UTENZA,TIPO_OFFERTA,TIPO_ORDERITEM,TIPO_SERVIZIO,TRATTAMENTO_IVA,VIA,VIA_FILIALE   from NCS_SIE_D_CONTRATTI
 where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_CONTRATTI
insert /*+ append */ into NCS_SIE_H_DELEGHE(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date
, ncs_dml_last_type, ncs_dml_old_new,CODICE_CLIENTE,ID_CONTATTO from NCS_SIE_D_DELEGHE

copied 0 rows from D to H for NCS_SIE_X_DELEGHE
delete from NCS_SIE_Y_DELEGHE where (CODICE_CLIENTE,ID_CONTATTO) in ( select CODICE_CLIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_ne
w='O')

deleted 0 rows from Y for NCS_SIE_X_DELEGHE
insert into NCS_SIE_Y_DELEGHE (ncs_dml_last_date, ncs_dml_last_type, CODICE_CLIENTE,ID_CONTATTO) select ncs_dml_last_date, ncs_dml_last_type, CODICE_C
LIENTE,ID_CONTATTO   from NCS_SIE_D_DELEGHE  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_DELEGHE
insert /*+ append */ into NCS_SIE_H_RS(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTAT
TO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,AREA,CODICE_CLIENTE,DATA_APERTU
RA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,N_RS,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO from NCS_SIE_D_RS

copied 0 rows from D to H for NCS_SIE_X_RS
delete from NCS_SIE_Y_RS where (N_RS) in ( select N_RS   from NCS_SIE_D_RS  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_RS
insert into NCS_SIE_Y_RS (ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATTO,RS_DESCR
IZIONE,SOTTOTIPO,STATO,TIPO) select ncs_dml_last_date, ncs_dml_last_type, N_RS,AREA,CODICE_CLIENTE,DATA_APERTURA,DATA_CHIUSURA,ID_CONTATTO,ID_CONTRATT
O,RS_DESCRIZIONE,SOTTOTIPO,STATO,TIPO   from NCS_SIE_D_RS  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_RS
insert /*+ append */ into NCS_SIE_H_SITO(ncs_dml_last_date, ncs_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATR
ICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, nc
s_dml_last_type, ncs_dml_old_new,CAP,CITTA,CODICE_USO,ID_CONTRATTO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBI
LE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA from NCS_SIE_D_SITO

copied 0 rows from D to H for NCS_SIE_X_SITO
delete from NCS_SIE_Y_SITO where (ID_CONTRATTO) in ( select ID_CONTRATTO   from NCS_SIE_D_SITO  where ncs_dml_old_new='O')
deleted 0 rows from Y for NCS_SIE_X_SITO
insert into NCS_SIE_Y_SITO (ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMER
O_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_CONTATORE,VIA) select ncs_dml_last_date, ncs_dml_last_type, ID_CONTRATTO
,CAP,CITTA,CODICE_USO,LIVELLO_TENSIONE,MATRICOLA_CONTATORE,NAZIONE,NUMERO_PRESA,PDR,POD,POTENZA_DISPONIBILE,POTENZA_IMPEGNATA,PROVINCIA,TENSIONE,TIPO_
CONTATORE,VIA   from NCS_SIE_D_SITO  where ncs_dml_old_new='N'

inserted 0 rows into Y from D for NCS_SIE_X_SITO
end of perform_refresh_siebel
start of perform_bv_users_load
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of load_new_files
start of fill_bv_users_files
end of fill_bv_users_files
end of load_new_files - 0 files loaded.
end of perform_bv_users_load
start of perform_app_cleanup
calling SP pkg_utenti.disattivazione_utenze
SP pkg_utenti.disattivazione_utenze returns 0 (ok)
end of perform_app_cleanup
start of perform_cleanup
cleaning up table NCS_SIE_H_CLIENTI for NCS_SIE_X_CLIENTI
death line of NCS_SIE_H_CLIENTI: never
cleaning up table NCS_SIE_H_CONTATTI for NCS_SIE_X_CONTATTI
death line of NCS_SIE_H_CONTATTI: never
cleaning up table NCS_SIE_H_CONTRATTI for NCS_SIE_X_CONTRATTI
death line of NCS_SIE_H_CONTRATTI: never
cleaning up table NCS_SIE_H_DELEGHE for NCS_SIE_X_DELEGHE
death line of NCS_SIE_H_DELEGHE: never
cleaning up table NCS_SIE_H_RS for NCS_SIE_X_RS
death line of NCS_SIE_H_RS: never
cleaning up table NCS_SIE_H_SITO for NCS_SIE_X_SITO
death line of NCS_SIE_H_SITO: never
cleaning up ncs_logs older then 2010-01-19 00:00:00
removed 0 logs.
end of perform_cleanup
start of lock_tables_statistics
end of lock_tables_statistics.
start of perform_statistics
"alter session set workarea_size_policy=manual"
"alter session set sort_area_size=400000000"
"alter session set hash_area_size=400000000"
start of gather_table_stats_wrap for NCS_LOG
end of gather_table_stats_wrap for NCS_LOG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO
end of gather_table_stats_wrap for NCS_SYNCHRO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_RUOLI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BO
end of gather_table_stats_wrap for NCS_UTENTI_BO; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_REG_CONT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for MV_CAPABILITIES_TABLE
end of gather_table_stats_wrap for MV_CAPABILITIES_TABLE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_ASS_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_CRE_CONT_QTAB; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_CRE_CONT; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_REG_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT
end of gather_table_stats_wrap for NCS_QUEUEDATA_ASS_CONT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI
end of gather_table_stats_wrap for NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_ATTIVAZIONI
end of gather_table_stats_wrap for NCS_ATTIVAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONFIG
end of gather_table_stats_wrap for NCS_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI
end of gather_table_stats_wrap for NCS_TRACCIAMENTO_ACCESSI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_UTENTI_BV
end of gather_table_stats_wrap for NCS_UTENTI_BV; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_BV_USERS_FILES
end of gather_table_stats_wrap for NCS_BV_USERS_FILES; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_D_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SYNCHRO_SAP
end of gather_table_stats_wrap for NCS_SYNCHRO_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE_SAP
end of gather_table_stats_wrap for NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT
end of gather_table_stats_wrap for NCS_QUEUEDATA_MOD_IFAT; elapsed=0 sec
start of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB
end of gather_table_stats_wrap for NCS_QUEUE_MOD_IFAT_QTAB; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_XY_TTL_CONFIG
end of gather_table_stats_wrap for NCS_XY_TTL_CONFIG; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_SAP; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_UTENTI
end of gather_table_stats_wrap for MLOG$_NCS_UTENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_RS
end of gather_table_stats_wrap for NCS_SIE_D_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RICERCA_BO
end of gather_table_stats_wrap for NCS_RICERCA_BO; elapsed=5 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_SITO
end of gather_table_stats_wrap for NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_X_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_X_CONTRATTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_X_DELEGHE; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_X_RS
end of gather_table_stats_wrap for NCS_SIE_X_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_X_SITO
end of gather_table_stats_wrap for NCS_SIE_X_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_Y_CONTRATTI; elapsed=2 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_RS
end of gather_table_stats_wrap for NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_Y_SITO
end of gather_table_stats_wrap for NCS_SIE_Y_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SIE_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_DELEGHE
end of gather_table_stats_wrap for NCS_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CLIENTI
end of gather_table_stats_wrap for NCS_CLIENTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_DELEGHE_CONTATTI_CLI
end of gather_table_stats_wrap for NCS_DELEGHE_CONTATTI_CLI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CLIENTI
end of gather_table_stats_wrap for MLOG$_NCS_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI
end of gather_table_stats_wrap for NCS_CONTATTI_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI1
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI_CLIENTI1; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTATTI
end of gather_table_stats_wrap for NCS_CONTATTI; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SAP_Y_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SAP_Y_CLIENTI
end of gather_table_stats_wrap for NCS_SAP_Y_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for MLOG$_NCS_CONTATTI
end of gather_table_stats_wrap for MLOG$_NCS_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_CONTRATTI
end of gather_table_stats_wrap for NCS_CONTRATTI; elapsed=2 sec
start of gather_table_stats_wrap for MLOG$_NCS_DELEGHE
end of gather_table_stats_wrap for MLOG$_NCS_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RS
end of gather_table_stats_wrap for NCS_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SITO
end of gather_table_stats_wrap for NCS_SITO; elapsed=.9 sec
start of gather_table_stats_wrap for MLOG$_NCS_SITO
end of gather_table_stats_wrap for MLOG$_NCS_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_H_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_CLIENTI
end of gather_table_stats_wrap for NCS_SIE_D_CLIENTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_H_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_CONTATTI
end of gather_table_stats_wrap for NCS_SIE_D_CONTATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_H_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_CONTRATTI
end of gather_table_stats_wrap for NCS_SIE_D_CONTRATTI; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_SIE_H_DELEGHE
end of gather_table_stats_wrap for NCS_SIE_H_DELEGHE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_RS
end of gather_table_stats_wrap for NCS_SIE_H_RS; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_H_SITO
end of gather_table_stats_wrap for NCS_SIE_H_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_SIE_D_SITO
end of gather_table_stats_wrap for NCS_SIE_D_SITO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_BV_USERS_EXT
skipping external table NCS_BV_USERS_EXT
start of gather_table_stats_wrap for NCS_DIR_LIST_TEMP
end of gather_table_stats_wrap for NCS_DIR_LIST_TEMP; elapsed=0 sec
start of gather_table_stats_wrap for NCS_STATI_UTENTE
end of gather_table_stats_wrap for NCS_STATI_UTENTE; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RS_MESSAGGI
end of gather_table_stats_wrap for NCS_RS_MESSAGGI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_RUOLI_BO
end of gather_table_stats_wrap for NCS_RUOLI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_FUNZIONI_BO
end of gather_table_stats_wrap for NCS_FUNZIONI_BO; elapsed=0 sec
start of gather_table_stats_wrap for NCS_LABEL_CONTRATTI
end of gather_table_stats_wrap for NCS_LABEL_CONTRATTI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_STATI_ORDINE
end of gather_table_stats_wrap for NCS_STATI_ORDINE; elapsed=.9 sec
start of gather_table_stats_wrap for NCS_OPERAZIONI
end of gather_table_stats_wrap for NCS_OPERAZIONI; elapsed=0 sec
start of gather_table_stats_wrap for NCS_GRUPPI
end of gather_table_stats_wrap for NCS_GRUPPI; elapsed=0 sec
end of perform_statistics

1139 rows selected.

SQL> truncate table ncs_log;

Table truncated.

SQL> exit
